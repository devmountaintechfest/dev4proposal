;/*FB_PKG_DELIM*/

__d("CometMessengerShareGating",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("495")===!0}g.shouldEnableBCFSingleFetchXMA=a}),98);
__d("LexicalLinkPlugin",["cr:2067"],(function(a,b,c,d,e,f){e.exports=b("cr:2067")}),null);
/**
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 *
 * @fullSyntaxTransform
 * @generated
 * @noflow
 * @nolint
 * @oncall lexical_web_text_editor
 * @preserve-invariant-messages
 * @preserve-whitespace
 * @preventMunge
 */__d("LexicalLinkPlugin.prod",["Lexical","LexicalComposerContext","LexicalLink","LexicalUtils","react"],(function $module_LexicalLinkPlugin_prod(global,require,requireDynamic,requireLazy,module,exports){

'use strict';var _require_closure_react;var n=_require_closure_react||(_require_closure_react=require("react"));
exports.LinkPlugin=function(_ref){var d=_ref.validateUrl,g=_ref.attributes;var _c$useLexicalComposer=require("LexicalComposerContext").useLexicalComposerContext(),e=_c$useLexicalComposer[0];n.useEffect(function(){if(!e.hasNodes([require("LexicalLink").LinkNode]))throw Error("LinkPlugin: LinkNode not registered on editor");return require("LexicalUtils").mergeRegister(e.registerCommand(require("LexicalLink").TOGGLE_LINK_COMMAND,function(a){if(null===a)return require("LexicalLink").$toggleLink(a),!0;if("string"===typeof a)return void 0===d||d(a)?(require("LexicalLink").$toggleLink(a,g),!0):!1;var f=a.url,h=a.target,k=a.rel,p=a.title;require("LexicalLink").$toggleLink(f,babelHelpers["extends"]({},g,{rel:k,target:h,title:p}));return!0;},require("Lexical").COMMAND_PRIORITY_LOW),
void 0!==d?e.registerCommand(require("Lexical").PASTE_COMMAND,function(a){var f=require("Lexical").$getSelection();if(!require("Lexical").$isRangeSelection(f)||f.isCollapsed()||!require("LexicalUtils").objectKlassEquals(a,ClipboardEvent)||null===a.clipboardData)return!1;var h=a.clipboardData.getData("text");return d(h)?f.getNodes().some(function(k){return require("Lexical").$isElementNode(k);})?!1:(e.dispatchCommand(require("LexicalLink").TOGGLE_LINK_COMMAND,babelHelpers["extends"]({},g,{url:h})),a.preventDefault(),!0):!1;},require("Lexical").COMMAND_PRIORITY_LOW):function(){});},[e,d,g]);return null;};}),null);
__d("LexicalTable",["cr:1950"],(function(a,b,c,d,e,f){e.exports=b("cr:1950")}),null);
/**
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 *
 * @fullSyntaxTransform
 * @generated
 * @noflow
 * @nolint
 * @oncall lexical_web_text_editor
 * @preserve-invariant-messages
 * @preserve-whitespace
 * @preventMunge
 */__d("LexicalTable.prod",["Lexical","LexicalClipboard","LexicalUtils"],(function $module_LexicalTable_prod(global,require,requireDynamic,requireLazy,module,exports){

'use strict';var ba=/^(\d+(?:\.\d+)?)px$/,y={BOTH:3,COLUMN:2,NO_STATUS:0,ROW:1};var
A=function(_u$ElementNode){babelHelpers.inheritsLoose(A,_u$ElementNode);A.getType=function getType(){return"tablecell";};A.clone=function clone(a){return new A(a.__headerState,a.__colSpan,a.__width,a.__key);};var _proto=A.prototype;_proto.afterCloneFrom=function afterCloneFrom(a){_u$ElementNode.prototype.afterCloneFrom.call(this,a);this.__rowSpan=a.__rowSpan;this.__backgroundColor=a.__backgroundColor;};A.importDOM=function importDOM(){return{td:function td(){return{conversion:ca,priority:0};},th:function th(){return{conversion:ca,priority:0};}};};A.importJSON=function importJSON(a){var b=a.rowSpan||1;return B(a.headerState,a.colSpan||1,a.width||void 0).setRowSpan(b).setBackgroundColor(a.backgroundColor||null);};function A(a,
b,c,d){var _this;if(a===void 0){a=y.NO_STATUS;}if(b===void 0){b=1;}_this=_u$ElementNode.call(this,d)||this;_this.__colSpan=b;_this.__rowSpan=1;_this.__headerState=a;_this.__width=c;_this.__backgroundColor=null;return _this;}_proto.createDOM=function createDOM(a){var b=document.createElement(this.getTag());this.__width&&(b.style.width=this.__width+"px");1<this.__colSpan&&(b.colSpan=this.__colSpan);1<this.__rowSpan&&(b.rowSpan=this.__rowSpan);null!==this.__backgroundColor&&(b.style.backgroundColor=this.__backgroundColor);require("LexicalUtils").addClassNamesToElement(b,a.theme.tableCell,this.hasHeader()&&a.theme.tableCellHeader);return b;};_proto.exportDOM=function exportDOM(a){var _u$ElementNode$protot=_u$ElementNode.prototype.
exportDOM.call(this,a);a=_u$ElementNode$protot.element;if(a){a.style.border="1px solid black";1<this.__colSpan&&(a.colSpan=this.__colSpan);1<this.__rowSpan&&(a.rowSpan=this.__rowSpan);a.style.width=(this.getWidth()||75)+"px";a.style.verticalAlign="top";a.style.textAlign="start";var b=this.getBackgroundColor();null!==b?a.style.backgroundColor=b:this.hasHeader()&&(a.style.backgroundColor="#f2f3f5");}return{element:a};};_proto.exportJSON=function exportJSON(){return babelHelpers["extends"]({},_u$ElementNode.prototype.exportJSON.call(this),{backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,
rowSpan:this.__rowSpan,type:"tablecell",width:this.getWidth()});};_proto.getColSpan=function getColSpan(){return this.getLatest().__colSpan;};_proto.setColSpan=function setColSpan(a){var b=this.getWritable();b.__colSpan=a;return b;};_proto.getRowSpan=function getRowSpan(){return this.getLatest().__rowSpan;};_proto.setRowSpan=function setRowSpan(a){var b=this.getWritable();b.__rowSpan=a;return b;};_proto.getTag=function getTag(){return this.hasHeader()?"th":"td";};_proto.setHeaderStyles=function setHeaderStyles(a,b){if(b===void 0){b=y.BOTH;}var c=this.getWritable();c.__headerState=a&b|c.__headerState&~b;return c;};_proto.getHeaderStyles=function getHeaderStyles(){return this.getLatest().__headerState;};_proto.setWidth=function setWidth(a){var b=this.getWritable();
b.__width=a;return b;};_proto.getWidth=function getWidth(){return this.getLatest().__width;};_proto.getBackgroundColor=function getBackgroundColor(){return this.getLatest().__backgroundColor;};_proto.setBackgroundColor=function setBackgroundColor(a){var b=this.getWritable();b.__backgroundColor=a;return b;};_proto.toggleHeaderStyle=function toggleHeaderStyle(a){var b=this.getWritable();b.__headerState=(b.__headerState&a)===a?b.__headerState-a:b.__headerState+a;return b;};_proto.hasHeaderState=function hasHeaderState(a){return(this.getHeaderStyles()&a)===a;};_proto.hasHeader=function hasHeader(){return this.getLatest().__headerState!==y.NO_STATUS;};_proto.updateDOM=function updateDOM(a){return a.__headerState!==this.__headerState||
a.__width!==this.__width||a.__colSpan!==this.__colSpan||a.__rowSpan!==this.__rowSpan||a.__backgroundColor!==this.__backgroundColor;};_proto.isShadowRoot=function isShadowRoot(){return!0;};_proto.collapseAtStart=function collapseAtStart(){return!0;};_proto.canBeEmpty=function canBeEmpty(){return!1;};_proto.canIndent=function canIndent(){return!1;};return A;}(require("Lexical").ElementNode);
function ca(a){var b=a.nodeName.toLowerCase(),c=void 0;ba.test(a.style.width)&&(c=parseFloat(a.style.width));b=B("th"===b?y.ROW:y.NO_STATUS,a.colSpan,c);b.__rowSpan=a.rowSpan;c=a.style.backgroundColor;""!==c&&(b.__backgroundColor=c);a=a.style;c=(a&&a.textDecoration||"").split(" ");var d="700"===a.fontWeight||"bold"===a.fontWeight,f=c.includes("line-through"),e="italic"===a.fontStyle,g=c.includes("underline");return{after:function after(m){0===m.length&&m.push(require("Lexical").$createParagraphNode());return m;},forChild:function forChild(m,p)
{if(C(p)&&!require("Lexical").$isElementNode(m)){p=require("Lexical").$createParagraphNode();if(require("Lexical").$isLineBreakNode(m)&&"\n"===m.getTextContent())return null;require("Lexical").$isTextNode(m)&&(d&&m.toggleFormat("bold"),f&&m.toggleFormat("strikethrough"),e&&m.toggleFormat("italic"),g&&m.toggleFormat("underline"));p.append(m);return p;}return m;},node:b};}function B(a,b,c){if(b===void 0){b=1;}return require("Lexical").$applyNodeReplacement(new A(a,b,c));}function C(a){return a instanceof A;}var da=require("Lexical").createCommand("INSERT_TABLE_COMMAND");var D;
function F(a){var b=new URLSearchParams();b.append("code",a);for(var c=1;c<arguments.length;c++){b.append("v",arguments[c]);}throw Error("Minified Lexical error #"+a+"; visit https://lexical.dev/docs/error?"+b+" for the full message or "+"use the non-minified dev environment for full errors and additional helpful warnings.");}D=F&&F.__esModule&&Object.prototype.hasOwnProperty.call(F,"default")?F["default"]:F;var ea="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;var
fa=function(_u$ElementNode2){babelHelpers.inheritsLoose(fa,_u$ElementNode2);fa.getType=function getType(){return"tablerow";};fa.clone=function clone(a){return new fa(a.__height,a.__key);};fa.importDOM=function importDOM(){return{tr:function tr(){return{conversion:ha,priority:0};}};};fa.importJSON=function importJSON(a){return I(a.height);};function fa(a,b){var _this2;_this2=_u$ElementNode2.call(this,b)||this;_this2.__height=a;return _this2;}var _proto2=fa.prototype;_proto2.exportJSON=function exportJSON(){return babelHelpers["extends"]({},_u$ElementNode2.prototype.exportJSON.call(this),this.getHeight()&&{height:this.getHeight()},{type:"tablerow",version:1});};_proto2.createDOM=function createDOM(a){var b=document.createElement("tr");this.__height&&(b.style.height=this.__height+"px");require("LexicalUtils").addClassNamesToElement(b,
a.theme.tableRow);return b;};_proto2.isShadowRoot=function isShadowRoot(){return!0;};_proto2.setHeight=function setHeight(a){this.getWritable().__height=a;return this.__height;};_proto2.getHeight=function getHeight(){return this.getLatest().__height;};_proto2.updateDOM=function updateDOM(a){return a.__height!==this.__height;};_proto2.canBeEmpty=function canBeEmpty(){return!1;};_proto2.canIndent=function canIndent(){return!1;};return fa;}(require("Lexical").ElementNode);function ha(a){var b=void 0;ba.test(a.style.height)&&(b=parseFloat(a.style.height));return{node:I(b)};}function I(a){return require("Lexical").$applyNodeReplacement(new fa(a));}function K(a){return a instanceof fa;}
function ia(a){a=require("LexicalUtils").$findMatchingParent(a,function(b){return K(b);});if(K(a))return a;throw Error("Expected table cell to be inside of table row.");}function ja(a){a=require("LexicalUtils").$findMatchingParent(a,function(b){return L(b);});if(L(a))return a;throw Error("Expected table cell to be inside of table.");}function ka(a,b){var c=ja(a),_c$getCordsFromCellNo=c.getCordsFromCellNode(a,b),d=_c$getCordsFromCellNo.x,f=_c$getCordsFromCellNo.y;return{above:c.getCellNodeFromCords(d,f-1,b),below:c.getCellNodeFromCords(d,f+1,b),left:c.getCellNodeFromCords(d-1,f,b),right:c.getCellNodeFromCords(d+1,f,b)};}
var la=function la(a,b){return a===y.BOTH||a===b?b:y.NO_STATUS;};function N(a){var b=a.getFirstDescendant();null==b?a.selectStart():b.getParentOrThrow().selectStart();}function ma(a,b){var c=a.getFirstChild();null!==c?c.insertBefore(b):a.append(b);}function O(a,b,c){var _na=na(a,b,c),d=_na[0],f=_na[1],e=_na[2];null===f&&D(207);null===e&&D(208);return[d,f,e];}
function na(a,b,c){function d(p){var r=f[p];void 0===r&&(f[p]=r=[]);return r;}var f=[],e=null,g=null;a=a.getChildren();for(var p=0;p<a.length;p++){var m=a[p];K(m)||D(209);for(var r=m.getFirstChild(),v=0;null!=r;r=r.getNextSibling()){C(r)||D(147);for(m=d(p);void 0!==m[v];){v++;}m={cell:r,startColumn:v,startRow:p};var _r=r,w=_r.__rowSpan,l=_r.__colSpan;for(var k=0;k<w&&!(p+k>=a.length);k++){var n=d(p+k);for(var q=0;q<l;q++){n[v+q]=m;}}null!==b&&null===e&&b.is(r)&&(e=m);null!==c&&null===g&&c.is(r)&&(g=m);}}return[f,
e,g];}function P(a){a instanceof A||("__type"in a?(a=require("LexicalUtils").$findMatchingParent(a,C),C(a)||D(148)):(a=require("LexicalUtils").$findMatchingParent(a.getNode(),C),C(a)||D(148)));var b=a.getParent();K(b)||D(149);var c=b.getParent();L(c)||D(210);return[a,b,c];}
function oa(a){var _P=P(a),b=_P[0],c=_P[2];a=c.getChildren();var d=a.length;var f=a[0].getChildren().length;var e=Array(d);for(var g=0;g<d;g++){e[g]=Array(f);}for(f=0;f<d;f++){g=a[f].getChildren();var m=0;for(var p=0;p<g.length;p++){for(;e[f][m];){m++;}var r=g[p],v=r.__rowSpan||1,w=r.__colSpan||1;for(var l=0;l<v;l++){for(var k=0;k<w;k++){e[f+l][m+k]=r;}}if(b===r)return{colSpan:w,columnIndex:m,rowIndex:f,rowSpan:v};m+=w;}}return null;}var
pa=function(){function pa(a,b,c){this.anchor=b;this.focus=c;b._selection=this;c._selection=this;this._cachedNodes=null;this.dirty=!1;this.tableKey=a;}var _proto3=pa.prototype;_proto3.getStartEndPoints=function getStartEndPoints(){return[this.anchor,this.focus];};_proto3.isBackward=function isBackward(){return this.focus.isBefore(this.anchor);};_proto3.getCachedNodes=function getCachedNodes(){return this._cachedNodes;};_proto3.setCachedNodes=function setCachedNodes(a){this._cachedNodes=a;};_proto3.is=function is(a){return Q(a)?this.tableKey===a.tableKey&&this.anchor.is(a.anchor)&&this.focus.is(a.focus):!1;};_proto3.set=function set(a,b,c){this.dirty=!0;this.tableKey=a;this.anchor.key=b;this.focus.key=c;
this._cachedNodes=null;};_proto3.clone=function clone(){return new pa(this.tableKey,this.anchor,this.focus);};_proto3.isCollapsed=function isCollapsed(){return!1;};_proto3.extract=function extract(){return this.getNodes();};_proto3.insertRawText=function insertRawText(){};_proto3.insertText=function insertText(){};_proto3.hasFormat=function hasFormat(a){var b=0;this.getNodes().filter(C).forEach(function(c){c=c.getFirstChild();require("Lexical").$isParagraphNode(c)&&(b|=c.getTextFormat());});return 0!==(b&require("Lexical").TEXT_TYPE_TO_FORMAT[a]);};_proto3.insertNodes=function insertNodes(a){var b=this.focus.getNode();require("Lexical").$isElementNode(b)||D(151);require("Lexical").$normalizeSelection__EXPERIMENTAL(b.select(0,b.getChildrenSize())).insertNodes(a);};_proto3.getShape=function getShape(){var a=
require("Lexical").$getNodeByKey(this.anchor.key);C(a)||D(152);a=oa(a);null===a&&D(153);var b=require("Lexical").$getNodeByKey(this.focus.key);C(b)||D(154);var c=oa(b);null===c&&D(155);b=Math.min(a.columnIndex,c.columnIndex);var d=Math.max(a.columnIndex+a.colSpan-1,c.columnIndex+c.colSpan-1),f=Math.min(a.rowIndex,c.rowIndex);a=Math.max(a.rowIndex+a.rowSpan-1,c.rowIndex+c.rowSpan-1);return{fromX:Math.min(b,d),fromY:Math.min(f,a),toX:Math.max(b,d),toY:Math.max(f,a)};};_proto3.getNodes=function getNodes(){function a(t){var x=t.cell,z=t.startColumn,E=t.startRow;r=
Math.min(r,z);v=Math.min(v,E);w=Math.max(w,z+x.__colSpan-1);l=Math.max(l,E+x.__rowSpan-1);}var b=this._cachedNodes;if(null!==b)return b;var c=this.anchor.getNode();b=this.focus.getNode();var d=require("LexicalUtils").$findMatchingParent(c,C);c=require("LexicalUtils").$findMatchingParent(b,C);C(d)||D(152);C(c)||D(154);b=d.getParent();K(b)||D(156);b=b.getParent();L(b)||D(157);var f=c.getParents()[1];if(f!==b){if(b.isParentOf(c)){var e=f.getParent();null==e&&D(159);this.set(this.tableKey,c.getKey(),e.getKey());}else e=b.getParent(),null==e&&D(158),
this.set(this.tableKey,e.getKey(),c.getKey());return this.getNodes();}var _O=O(b,d,c),g=_O[0],m=_O[1],p=_O[2],r=Math.min(m.startColumn,p.startColumn),v=Math.min(m.startRow,p.startRow),w=Math.max(m.startColumn+m.cell.__colSpan-1,p.startColumn+p.cell.__colSpan-1),l=Math.max(m.startRow+m.cell.__rowSpan-1,p.startRow+p.cell.__rowSpan-1);c=r;d=v;f=r;for(var k=v;r<c||v<d||w>f||l>k;){if(r<c){var n=k-d;--c;for(var q=0;q<=n;q++){a(g[d+q][c]);}}if(v<d)for(n=f-c,--d,q=0;q<=n;q++){a(g[d][c+q]);}if(w>f)for(n=k-d,f+=1,q=0;q<=n;q++){a(g[d+
q][f]);}if(l>k)for(n=f-c,k+=1,q=0;q<=n;q++){a(g[k][c+q]);}}b=new Map([[b.getKey(),b]]);c=null;for(d=v;d<=l;d++){for(f=r;f<=w;f++){k=g[d][f].cell;n=k.getParent();K(n)||D(160);n!==c&&b.set(n.getKey(),n);b.set(k.getKey(),k);for(var _iterator=qa(k),_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(_isArray){if(_i>=_iterator.length)break;e=_iterator[_i++];}else{_i=_iterator.next();if(_i.done)break;e=_i.value;}b.set(e.getKey(),e);}c=n;}}e=Array.from(b.values());require("Lexical").isCurrentlyReadOnlyMode()||(this._cachedNodes=e);return e;};_proto3.getTextContent=function getTextContent(){var a=this.getNodes().filter(function(c){return C(c);}),b="";for(var c=0;c<a.length;c++){var d=a[c],f=d.__parent,e=(a[c+1]||{}).__parent;b+=d.getTextContent()+(
e!==f?"\n":"\t");}return b;};return pa;}();function Q(a){return a instanceof pa;}function ra(){var a=require("Lexical").$createPoint("root",0,"element"),b=require("Lexical").$createPoint("root",0,"element");return new pa("root",a,b);}function qa(a){var b=[],c=[a];for(;0<c.length;){var d=c.pop();void 0===d&&D(112);require("Lexical").$isElementNode(d)&&c.unshift.apply(c,d.getChildren());d!==a&&b.push(d);}return b;}
function ta(a,b){if(b===void 0){b=require("Lexical").$getEditor();}var c=require("Lexical").$getNodeByKey(a);if(!L(c))throw Error("TableObserver: Expected tableNodeKey "+a+" to be a TableNode");b=R(c,b.getElementByKey(a));if(null===b)throw Error("TableObserver: Expected to find TableElement in DOM for key "+a);return{tableElement:b,tableNode:c};}var
ua=function(){function ua(a,b){this.isHighlightingCells=!1;this.focusY=this.focusX=this.anchorY=this.anchorX=-1;this.listenersToRemove=new Set();this.tableNodeKey=b;this.editor=a;this.table={columns:0,domRows:[],rows:0};this.focusCell=this.anchorCell=this.focusCellNodeKey=this.anchorCellNodeKey=this.tableSelection=null;this.shouldCheckSelection=this.isSelecting=this.hasHijackedSelectionStyles=!1;this.abortController=new AbortController();this.listenerOptions={signal:this.abortController.signal};this.trackTable();}var _proto4=ua.prototype;_proto4.getTable=function getTable(){return this.table;};_proto4.removeListeners=function removeListeners(){this.abortController.abort("removeListeners");
Array.from(this.listenersToRemove).forEach(function(a){return a();});this.listenersToRemove.clear();};_proto4.$lookup=function $lookup(){return ta(this.tableNodeKey,this.editor);};_proto4.trackTable=function trackTable(){var _this4=this;var a=new MutationObserver(function(b){_this4.editor.getEditorState().read(function(){var c=!1;for(var e=0;e<b.length;e++){var g=b[e].target.nodeName;if("TABLE"===g||"TBODY"===g||"THEAD"===g||"TR"===g){c=!0;break;}}if(c){var _this4$$lookup=_this4.$lookup(),d=_this4$$lookup.tableNode,f=_this4$$lookup.tableElement;_this4.table=S(d,f);}},{editor:_this4.editor});});this.editor.getEditorState().read(function(){var _this4$$lookup2=
_this4.$lookup(),b=_this4$$lookup2.tableNode,c=_this4$$lookup2.tableElement;_this4.table=S(b,c);a.observe(c,{attributes:!0,childList:!0,subtree:!0});},{editor:this.editor});};_proto4.clearHighlight=function clearHighlight(){var _this5=this;var a=this.editor;this.isHighlightingCells=!1;this.focusY=this.focusX=this.anchorY=this.anchorX=-1;this.focusCell=this.anchorCell=this.focusCellNodeKey=this.anchorCellNodeKey=this.tableSelection=null;this.hasHijackedSelectionStyles=!1;this.enableHighlightStyle();a.update(function(){var _this5$$lookup=_this5.$lookup(),b=_this5$$lookup.tableNode,c=_this5$$lookup.tableElement,d=S(b,c);va(a,d,null);require("Lexical").$setSelection(null);a.dispatchCommand(require("Lexical").SELECTION_CHANGE_COMMAND,
void 0);});};_proto4.enableHighlightStyle=function enableHighlightStyle(){var _this6=this;var a=this.editor;a.getEditorState().read(function(){var _this6$$lookup=_this6.$lookup(),b=_this6$$lookup.tableElement;require("LexicalUtils").removeClassNamesFromElement(b,a._config.theme.tableSelection);b.classList.remove("disable-selection");_this6.hasHijackedSelectionStyles=!1;},{editor:a});};_proto4.disableHighlightStyle=function disableHighlightStyle(){var _this7=this;var a=this.editor;a.getEditorState().read(function(){var _this7$$lookup=_this7.$lookup(),b=_this7$$lookup.tableElement;require("LexicalUtils").addClassNamesToElement(b,a._config.theme.tableSelection);_this7.hasHijackedSelectionStyles=!0;},{editor:a});};_proto4.updateTableTableSelection=function updateTableTableSelection(a){if(null!==
a&&a.tableKey===this.tableNodeKey){var b=this.editor;this.tableSelection=a;this.isHighlightingCells=!0;this.disableHighlightStyle();va(b,this.table,this.tableSelection);}else null==a?this.clearHighlight():(this.tableNodeKey=a.tableKey,this.updateTableTableSelection(a));};_proto4.setShouldCheckSelection=function setShouldCheckSelection(){this.shouldCheckSelection=!0;};_proto4.getAndClearShouldCheckSelection=function getAndClearShouldCheckSelection(){return this.shouldCheckSelection?(this.shouldCheckSelection=!1,!0):!1;};_proto4.setFocusCellForSelection=function setFocusCellForSelection(a,b){var _this8=this;if(b===void 0){b=!1;}var c=this.editor;c.update(function(){var _this8$$lookup=
_this8.$lookup(),d=_this8$$lookup.tableNode,f=a.x;var e=a.y;_this8.focusCell=a;if(null!==_this8.anchorCell){var g=ea?(c._window||window).getSelection():null;g&&g.setBaseAndExtent(_this8.anchorCell.elem,0,_this8.focusCell.elem,0);}if(!_this8.isHighlightingCells&&(_this8.anchorX!==f||_this8.anchorY!==e||b))_this8.isHighlightingCells=!0,_this8.disableHighlightStyle();else if(f===_this8.focusX&&e===_this8.focusY)return;_this8.focusX=f;_this8.focusY=e;_this8.isHighlightingCells&&(f=require("Lexical").$getNearestNodeFromDOMNode(a.elem),null!=_this8.tableSelection&&null!=_this8.anchorCellNodeKey&&
C(f)&&d.is(T(f))&&(d=f.getKey(),_this8.tableSelection=_this8.tableSelection.clone()||ra(),_this8.focusCellNodeKey=d,_this8.tableSelection.set(_this8.tableNodeKey,_this8.anchorCellNodeKey,_this8.focusCellNodeKey),require("Lexical").$setSelection(_this8.tableSelection),c.dispatchCommand(require("Lexical").SELECTION_CHANGE_COMMAND,void 0),va(c,_this8.table,_this8.tableSelection)));});};_proto4.setAnchorCellForSelection=function setAnchorCellForSelection(a){var _this9=this;this.isHighlightingCells=!1;this.anchorCell=a;this.anchorX=a.x;this.anchorY=a.y;this.editor.update(function(){var b=require("Lexical").$getNearestNodeFromDOMNode(a.elem);
C(b)&&(b=b.getKey(),_this9.tableSelection=null!=_this9.tableSelection?_this9.tableSelection.clone():ra(),_this9.anchorCellNodeKey=b);});};_proto4.formatCells=function formatCells(a){var _this10=this;this.editor.update(function(){var b=require("Lexical").$getSelection();Q(b)||D(11);var c=require("Lexical").$createRangeSelection(),d=c.anchor,f=c.focus,e=b.getNodes().filter(C),g=e[0].getFirstChild(),m=require("Lexical").$isParagraphNode(g)?g.getFormatFlags(a,null):null;e.forEach(function(p){d.set(p.getKey(),0,"element");f.set(p.getKey(),p.getChildrenSize(),"element");c.formatText(a,m);});require("Lexical").$setSelection(b);_this10.editor.dispatchCommand(require("Lexical").SELECTION_CHANGE_COMMAND,
void 0);});};_proto4.clearText=function clearText(){var _this11=this;var a=this.editor;a.update(function(){var b=require("Lexical").$getNodeByKey(_this11.tableNodeKey);if(!L(b))throw Error("Expected TableNode.");var c=require("Lexical").$getSelection();Q(c)||D(11);c=c.getNodes().filter(C);c.length===_this11.table.columns*_this11.table.rows?(b.selectPrevious(),b.remove(),require("Lexical").$getRoot().selectStart()):(c.forEach(function(d){if(require("Lexical").$isElementNode(d)){var f=require("Lexical").$createParagraphNode(),e=require("Lexical").$createTextNode();f.append(e);d.append(f);d.getChildren().forEach(function(g){g!==f&&g.remove();});}}),va(a,_this11.table,null),require("Lexical").$setSelection(null),
a.dispatchCommand(require("Lexical").SELECTION_CHANGE_COMMAND,void 0));});};return ua;}();function R(a,b){if(!b)return b;a="TABLE"===b.nodeName?b:a.getDOMSlot(b).element;if("TABLE"!==a.nodeName)throw Error("getTableElement: Expecting table in as DOM node for TableNode, not "+b.nodeName);return a;}function wa(a,b){null!==xa(a)&&D(205);a.__lexicalTableSelection=b;}function xa(a){return a.__lexicalTableSelection||null;}
function ya(a){for(;null!=a;){var b=a.nodeName;if("TD"===b||"TH"===b){a=a._cell;if(void 0===a)break;return a;}a=a.parentNode;}return null;}
function S(a,b){var c=R(a,b);a=[];b={columns:0,domRows:a,rows:0};var d=c.querySelector("tr");var f=c=0;for(a.length=0;null!=d;){var e=d.nodeName;if("TD"===e||"TH"===e){e=d;e={elem:e,hasBackgroundColor:""!==e.style.backgroundColor,highlighted:!1,x:c,y:f};d._cell=e;var g=a[f];void 0===g&&(g=a[f]=[]);g[c]=e;}else if(e=d.firstChild,null!=e){d=e;continue;}e=d.nextSibling;if(null!=e)c++,d=e;else if(e=d.parentNode,null!=e){d=e.nextSibling;if(null==d)break;f++;c=0;}}b.columns=c+1;b.rows=f+1;return b;}
function va(a,b,c){var d=new Set(c?c.getNodes():[]);za(b,function(f,e){var g=f.elem;d.has(e)?(f.highlighted=!0,Aa(a,f)):(f.highlighted=!1,Ba(a,f),g.getAttribute("style")||g.removeAttribute("style"));});}function za(a,b){var _a=a;a=_a.domRows;for(var c=0;c<a.length;c++){var d=a[c];if(d)for(var f=0;f<d.length;f++){var e=d[f];if(!e)continue;var g=require("Lexical").$getNearestNodeFromDOMNode(e.elem);null!==g&&b(e,g,{x:f,y:c});}}}function Ca(a,b){b.disableHighlightStyle();za(b.table,function(c){c.highlighted=!0;Aa(a,c);});}
function Da(a,b){b.enableHighlightStyle();za(b.table,function(c){var d=c.elem;c.highlighted=!1;Ba(a,c);d.getAttribute("style")||d.removeAttribute("style");});}
var Ea=function Ea(a,b,c,d,f){var e="forward"===f;switch(f){case"backward":case"forward":return c!==(e?a.table.columns-1:0)?(a=b.getCellNodeFromCordsOrThrow(c+(e?1:-1),d,a.table),e?a.selectStart():a.selectEnd()):d!==(e?a.table.rows-1:0)?(a=b.getCellNodeFromCordsOrThrow(e?0:a.table.columns-1,d+(e?1:-1),a.table),e?a.selectStart():a.selectEnd()):e?b.selectNext():b.selectPrevious(),!0;case"up":return 0!==d?b.getCellNodeFromCordsOrThrow(c,d-1,a.table).selectEnd():b.selectPrevious(),!0;case"down":return d!==
a.table.rows-1?b.getCellNodeFromCordsOrThrow(c,d+1,a.table).selectStart():b.selectNext(),!0;default:return!1;}},Fa=function Fa(a,b,c,d,f){var e="forward"===f;switch(f){case"backward":case"forward":return c!==(e?a.table.columns-1:0)&&a.setFocusCellForSelection(b.getDOMCellFromCordsOrThrow(c+(e?1:-1),d,a.table)),!0;case"up":return 0!==d?(a.setFocusCellForSelection(b.getDOMCellFromCordsOrThrow(c,d-1,a.table)),!0):!1;case"down":return d!==a.table.rows-1?(a.setFocusCellForSelection(b.getDOMCellFromCordsOrThrow(c,
d+1,a.table)),!0):!1;default:return!1;}};function U(a,b){if(require("Lexical").$isRangeSelection(a)||Q(a)){var c=b.isParentOf(a.anchor.getNode());a=b.isParentOf(a.focus.getNode());return c&&a;}return!1;}
function Aa(a,b){a=b.elem;b=require("Lexical").$getNearestNodeFromDOMNode(a);C(b)||D(131);null===b.getBackgroundColor()?a.style.setProperty("background-color","rgb(172,206,247)"):a.style.setProperty("background-image","linear-gradient(to right, rgba(172,206,247,0.85), rgba(172,206,247,0.85))");a.style.setProperty("caret-color","transparent");}
function Ba(a,b){a=b.elem;b=require("Lexical").$getNearestNodeFromDOMNode(a);C(b)||D(131);null===b.getBackgroundColor()&&a.style.removeProperty("background-color");a.style.removeProperty("background-image");a.style.removeProperty("caret-color");}function V(a){a=require("LexicalUtils").$findMatchingParent(a,C);return C(a)?a:null;}function T(a){a=require("LexicalUtils").$findMatchingParent(a,L);return L(a)?a:null;}
function W(a,b,c,d,f){if(("up"===c||"down"===c)&&Ga(a))return!1;var e=require("Lexical").$getSelection();if(!U(e,d)){if(require("Lexical").$isRangeSelection(e)){if(e.isCollapsed()&&"backward"===c){c=e.anchor.type;d=e.anchor.offset;if("element"!==c&&("text"!==c||0!==d))return!1;c=e.anchor.getNode();if(!c)return!1;c=require("LexicalUtils").$findMatchingParent(c,function(r){return require("Lexical").$isElementNode(r)&&!r.isInline();});if(!c)return!1;c=c.getPreviousSibling();if(!c||!L(c))return!1;X(b);c.selectEnd();return!0;}if(b.shiftKey&&("up"===c||"down"===c)){var g=e.focus.getNode();if(!e.isCollapsed()&&(
"up"===c&&!e.isBackward()||"down"===c&&e.isBackward())){f=require("LexicalUtils").$findMatchingParent(g,function(r){return L(r);});C(f)&&(f=require("LexicalUtils").$findMatchingParent(f,L));if(f!==d||!f)return!1;d="down"===c?f.getNextSibling():f.getPreviousSibling();if(!d)return!1;f=0;"up"===c&&require("Lexical").$isElementNode(d)&&(f=d.getChildrenSize());a=d;"up"===c&&require("Lexical").$isElementNode(d)&&(a=(c=d.getLastChild())?c:d,f=require("Lexical").$isTextNode(a)?a.getTextContentSize():0);c=e.clone();c.focus.set(a.getKey(),f,require("Lexical").$isTextNode(a)?"text":"element");require("Lexical").$setSelection(c);X(b);return!0;}if(require("Lexical").$isRootOrShadowRoot(g)){if((b=
"up"===c?e.getNodes()[e.getNodes().length-1]:e.getNodes()[0])&&(b=require("LexicalUtils").$findMatchingParent(b,C))&&d.isParentOf(b)){c=d.getFirstDescendant();b=d.getLastDescendant();if(!c||!b)return!1;var _P2=P(c);c=_P2[0];var _P3=P(b);b=_P3[0];c=d.getCordsFromCellNode(c,f.table);b=d.getCordsFromCellNode(b,f.table);c=d.getDOMCellFromCordsOrThrow(c.x,c.y,f.table);b=d.getDOMCellFromCordsOrThrow(b.x,b.y,f.table);f.setAnchorCellForSelection(c);f.setFocusCellForSelection(b,!0);return!0;}return!1;}d=require("LexicalUtils").$findMatchingParent(g,function(r){return require("Lexical").$isElementNode(r)&&!r.isInline();});
C(d)&&(d=require("LexicalUtils").$findMatchingParent(d,L));if(!d)return!1;d="down"===c?d.getNextSibling():d.getPreviousSibling();if(L(d)&&f.tableNodeKey===d.getKey()){f=d.getFirstDescendant();a=d.getLastDescendant();if(!f||!a)return!1;var _P4=P(f);d=_P4[0];var _P5=P(a);f=_P5[0];e=e.clone();e.focus.set(("up"===c?d:f).getKey(),"up"===c?0:f.getChildrenSize(),"element");X(b);require("Lexical").$setSelection(e);return!0;}}}"down"===c&&Ha(a)&&f.setShouldCheckSelection();return!1;}if(require("Lexical").$isRangeSelection(e)&&e.isCollapsed()){var _e=e,r=_e.anchor,v=_e.focus;g=require("LexicalUtils").$findMatchingParent(r.getNode(),
C);var m=require("LexicalUtils").$findMatchingParent(v.getNode(),C);if(!C(g)||!g.is(m))return!1;m=T(g);if(m!==d&&null!=m){var p=R(m,a.getElementByKey(m.getKey()));if(null!=p)return f.table=S(m,p),W(a,b,c,m,f);}if("backward"===c||"forward"===c){f=r.type;a=r.offset;g=r.getNode();if(!g)return!1;e=e.getNodes();return 1===e.length&&require("Lexical").$isDecoratorNode(e[0])?!1:Ja(f,a,g,c)?Ka(b,g,d,c):!1;}e=a.getElementByKey(g.__key);m=a.getElementByKey(r.key);if(null==m||null==e)return!1;if("element"===r.type)e=m.getBoundingClientRect();else{e=
window.getSelection();if(null===e||0===e.rangeCount)return!1;e=e.getRangeAt(0).getBoundingClientRect();}m="up"===c?g.getFirstChild():g.getLastChild();if(null==m)return!1;a=a.getElementByKey(m.__key);if(null==a)return!1;a=a.getBoundingClientRect();if("up"===c?a.top>e.top-e.height:e.bottom+e.height>a.bottom){X(b);e=d.getCordsFromCellNode(g,f.table);if(b.shiftKey)b=d.getDOMCellFromCordsOrThrow(e.x,e.y,f.table),f.setAnchorCellForSelection(b),f.setFocusCellForSelection(b,!0);else return Ea(f,d,e.x,e.y,
c);return!0;}}else if(Q(e)){var _e2=e,_r2=_e2.anchor,_v=_e2.focus;p=require("LexicalUtils").$findMatchingParent(_r2.getNode(),C);m=require("LexicalUtils").$findMatchingParent(_v.getNode(),C);var _e$getNodes=e.getNodes();g=_e$getNodes[0];if(!L(g))throw Error("$handleArrowKey: TableSelection.getNodes()[0] expected to be TableNode");a=R(g,a.getElementByKey(g.getKey()));if(!C(p)||!C(m)||!L(g)||null==a)return!1;f.updateTableTableSelection(e);e=S(g,a);a=d.getCordsFromCellNode(p,e);a=d.getDOMCellFromCordsOrThrow(a.x,a.y,e);f.setAnchorCellForSelection(a);X(b);if(b.shiftKey)return b=d.getCordsFromCellNode(m,
e),Fa(f,g,b.x,b.y,c);m.selectEnd();return!0;}return!1;}function X(a){a.preventDefault();a.stopImmediatePropagation();a.stopPropagation();}function Ga(a){return(a=a.getRootElement())?a.hasAttribute("aria-controls")&&"typeahead-menu"===a.getAttribute("aria-controls"):!1;}function Ja(a,b,c,d){return"element"===a&&("backward"===d?null===c.getPreviousSibling():null===c.getNextSibling())||La(a,b,c,d);}
function La(a,b,c,d){var f=require("LexicalUtils").$findMatchingParent(c,function(e){return require("Lexical").$isElementNode(e)&&!e.isInline();});if(!f)return!1;b="backward"===d?0===b:b===c.getTextContentSize();return"text"===a&&b&&("backward"===d?null===f.getPreviousSibling():null===f.getNextSibling());}
function Ka(a,b,c,d){var f=require("LexicalUtils").$findMatchingParent(b,C);if(!C(f))return!1;var _O2=O(c,f,f),e=_O2[0],g=_O2[1];f=e[0][0];var m=e[e.length-1][e[0].length-1],p=g.startColumn,r=g.startRow;if("backward"===d?p!==f.startColumn||r!==f.startRow:p!==m.startColumn||r!==m.startRow)return!1;b=Ma(b,d,c);if(!b||L(b))return!1;X(a);"backward"===d?b.selectEnd():b.selectStart();return!0;}
function Ma(a,b,c){if(a=require("LexicalUtils").$findMatchingParent(a,function(d){return require("Lexical").$isElementNode(d)&&!d.isInline();}))return(a="backward"===b?a.getPreviousSibling():a.getNextSibling())&&L(a)?a:"backward"===b?c.getPreviousSibling():c.getNextSibling();}function Na(a,b,c){var d=require("Lexical").$createParagraphNode();"first"===a?b.insertBefore(d):b.insertAfter(d);d.append.apply(d,c||[]);d.selectEnd();}
function Oa(a,b,c){var d=c.getParent();if(d){var f=window.getSelection();if(f&&(f=f.anchorNode,d=a.getElementByKey(d.getKey()),a=R(c,a.getElementByKey(c.getKey())),f&&d&&a&&d.contains(f)&&!a.contains(f)&&(b=require("LexicalUtils").$findMatchingParent(b.anchor.getNode(),function(r){return C(r);})))&&(a=require("LexicalUtils").$findMatchingParent(b,function(r){return L(r);}),L(a)&&a.is(c))){var _O3=O(c,b,b),e=_O3[0],g=_O3[1];c=e[0][0];b=e[e.length-1][e[0].length-1];var m=g.startRow,p=g.startColumn;if(m===c.startRow&&p===c.startColumn)return"first";if(m===b.startRow&&p===b.startColumn)return"last";}}}
function Pa(a,b,c,d){if(a=a.querySelector("colgroup")){var _a2;b=[];for(var f=0;f<c;f++){var e=document.createElement("col"),g=d&&d[f];g&&(e.style.width=g+"px");b.push(e);}(_a2=a).replaceChildren.apply(_a2,b);}}function Qa(a,b,c){c?(require("LexicalUtils").addClassNamesToElement(a,b.theme.tableRowStriping),a.setAttribute("data-lexical-row-striping","true")):(require("LexicalUtils").removeClassNamesFromElement(a,b.theme.tableRowStriping),a.removeAttribute("data-lexical-row-striping"));}var Ra=new WeakSet();function Ha(a){if(a===void 0){a=require("Lexical").$getEditor();}return Ra.has(a);}var
Sa=function(_u$ElementNode3){babelHelpers.inheritsLoose(Sa,_u$ElementNode3);Sa.getType=function getType(){return"table";};var _proto5=Sa.prototype;_proto5.getColWidths=function getColWidths(){return this.getLatest().__colWidths;};_proto5.setColWidths=function setColWidths(a){var b=this.getWritable();b.__colWidths=a;return b;};Sa.clone=function clone(a){return new Sa(a.__key);};_proto5.afterCloneFrom=function afterCloneFrom(a){_u$ElementNode3.prototype.afterCloneFrom.call(this,a);this.__colWidths=a.__colWidths;this.__rowStriping=a.__rowStriping;};Sa.importDOM=function importDOM(){return{table:function table(){return{conversion:Ta,priority:1};}};};Sa.importJSON=function importJSON(a){var b=Ua();b.__rowStriping=a.rowStriping||!1;b.__colWidths=a.colWidths;return b;};function Sa(a){var _this3;_this3=_u$ElementNode3.call(this,a)||this;
_this3.__rowStriping=!1;return _this3;}_proto5.exportJSON=function exportJSON(){return babelHelpers["extends"]({},_u$ElementNode3.prototype.exportJSON.call(this),{colWidths:this.getColWidths(),rowStriping:this.__rowStriping?this.__rowStriping:void 0,type:"table",version:1});};_proto5.getDOMSlot=function getDOMSlot(a){a="TABLE"!==a.nodeName&&a.querySelector("table")||a;if("TABLE"!==a.nodeName)throw Error("TableNode.getDOMSlot: createDOM() did not return a table");return _u$ElementNode3.prototype.getDOMSlot.call(this,a).withAfter(a.querySelector("colgroup"));};_proto5.createDOM=function createDOM(a,b){var c=document.createElement("table"),d=document.createElement("colgroup");c.appendChild(d);
Pa(c,a,this.getColumnCount(),this.getColWidths());require("Lexical").setDOMUnmanaged(d);require("LexicalUtils").addClassNamesToElement(c,a.theme.table);this.__rowStriping&&Qa(c,a,!0);return Ha(b)?(b=document.createElement("div"),(a=a.theme.tableScrollableWrapper)?require("LexicalUtils").addClassNamesToElement(b,a):b.style.cssText="overflow-x: auto;",b.appendChild(c),b):c;};_proto5.updateDOM=function updateDOM(a,b,c){a.__rowStriping!==this.__rowStriping&&Qa(b,c,this.__rowStriping);Pa(b,c,this.getColumnCount(),this.getColWidths());return!1;};_proto5.exportDOM=function exportDOM(a){return babelHelpers["extends"]({},_u$ElementNode3.prototype.exportDOM.call(this,a),{after:function after(b)
{b&&require("LexicalUtils").isHTMLElement(b)&&"TABLE"!==b.nodeName&&(b=b.querySelector("table"));if(!b||!require("LexicalUtils").isHTMLElement(b))return null;var c=b.querySelectorAll(":scope > tr");if(0<c.length){var d=document.createElement("tbody");d.append.apply(d,c);b.append(d);}return b;}});};_proto5.canBeEmpty=function canBeEmpty(){return!1;};_proto5.isShadowRoot=function isShadowRoot(){return!0;};_proto5.getCordsFromCellNode=function getCordsFromCellNode(a,b){var _b=b,c=_b.rows,d=_b.domRows;for(b=0;b<c;b++){var f=d[b];if(null!=f&&(f=f.findIndex(function(e){var _e3;if(e)return(_e3=e,e=_e3.elem,_e3),require("Lexical").$getNearestNodeFromDOMNode(e)===a;}),-1!==f))return{x:f,y:b};}throw Error("Cell not found in table.");
};_proto5.getDOMCellFromCords=function getDOMCellFromCords(a,b,c){var _c=c;c=_c.domRows;b=c[b];if(null==b)return null;a=b[a<b.length?a:b.length-1];return null==a?null:a;};_proto5.getDOMCellFromCordsOrThrow=function getDOMCellFromCordsOrThrow(a,b,c){a=this.getDOMCellFromCords(a,b,c);if(!a)throw Error("Cell not found at cords.");return a;};_proto5.getCellNodeFromCords=function getCellNodeFromCords(a,b,c){a=this.getDOMCellFromCords(a,b,c);if(null==a)return null;a=require("Lexical").$getNearestNodeFromDOMNode(a.elem);return C(a)?a:null;};_proto5.getCellNodeFromCordsOrThrow=function getCellNodeFromCordsOrThrow(a,b,c){a=this.getCellNodeFromCords(a,b,c);if(!a)throw Error("Node at cords not TableCellNode.");
return a;};_proto5.getRowStriping=function getRowStriping(){return!!this.getLatest().__rowStriping;};_proto5.setRowStriping=function setRowStriping(a){this.getWritable().__rowStriping=a;};_proto5.canSelectBefore=function canSelectBefore(){return!0;};_proto5.canIndent=function canIndent(){return!1;};_proto5.getColumnCount=function getColumnCount(){var a=this.getFirstChild();if(!a)return 0;var b=0;a.getChildren().forEach(function(c){C(c)&&(b+=c.getColSpan());});return b;};return Sa;}(require("Lexical").ElementNode);
function Ta(a){var b=Ua();a.hasAttribute("data-lexical-row-striping")&&b.setRowStriping(!0);var c=a.querySelector(":scope > colgroup");if(c){a=[];for(var _iterator2=c.querySelectorAll(":scope > col"),_isArray2=Array.isArray(_iterator2),_i2=0,_iterator2=_isArray2?_iterator2:_iterator2[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var _ref;if(_isArray2){if(_i2>=_iterator2.length)break;_ref=_iterator2[_i2++];}else{_i2=_iterator2.next();if(_i2.done)break;_ref=_i2.value;}var d=_ref;c=d.style.width;if(!c||!ba.test(c)){a=void 0;break;}a.push(parseFloat(c));}a&&b.setColWidths(a);}return{node:b};}function Ua(){return require("Lexical").$applyNodeReplacement(new Sa());}function L(a){return a instanceof Sa;}exports.$computeTableMap=O;exports.$computeTableMapSkipCellCheck=na;exports.$createTableCellNode=B;
exports.$createTableNode=Ua;exports.$createTableNodeWithDimensions=function(a,b,c){if(c===void 0){c=!0;}var d=Ua();for(var e=0;e<a;e++){var g=I();for(var m=0;m<b;m++){var f=y.NO_STATUS;"object"===typeof c?(0===e&&c.rows&&(f|=y.ROW),0===m&&c.columns&&(f|=y.COLUMN)):c&&(0===e&&(f|=y.ROW),0===m&&(f|=y.COLUMN));f=B(f);var p=require("Lexical").$createParagraphNode();p.append(require("Lexical").$createTextNode());f.append(p);g.append(f);}d.append(g);}return d;};exports.$createTableRowNode=I;exports.$createTableSelection=ra;
exports.$deleteTableColumn=function(a,b){var c=a.getChildren();for(var f=0;f<c.length;f++){var d=c[f];if(K(d)){d=d.getChildren();if(b>=d.length||0>b)throw Error("Table column target index out of range");d[b].remove();}}return a;};
exports.$deleteTableColumn__EXPERIMENTAL=function(){var a=require("Lexical").$getSelection();require("Lexical").$isRangeSelection(a)||Q(a)||D(188);var b=a.anchor.getNode();a=a.focus.getNode();var _P6=P(b),c=_P6[0],d=_P6[2];var _P7=P(a),f=_P7[0];var _O4=O(d,c,f),e=_O4[0],g=_O4[1],m=_O4[2];var p=g.startColumn;var r=m.startRow,v=m.startColumn;b=Math.min(p,v);var w=Math.max(p+c.__colSpan-1,v+f.__colSpan-1);a=w-b+1;if(e[0].length===w-b+1)d.selectPrevious(),d.remove();else{var _f,_ref2;var l=e.length;for(var k=0;k<l;k++){for(var n=b;n<=w;n++){var _e$k$n=e[k][n],q=_e$k$n.cell,t=_e$k$n.startColumn;t<b?n===b&&q.setColSpan(q.__colSpan-
Math.min(a,q.__colSpan-(b-t))):t+q.__colSpan-1>w?n===w&&q.setColSpan(q.__colSpan-(w-t+1)):q.remove();}}w=e[r];f=p>v?w[p+c.__colSpan]:w[v+f.__colSpan];void 0!==f?((_f=f,p=_f.cell,_f),N(p)):((_ref2=v<p?w[v-1]:w[p-1],p=_ref2.cell,_ref2),N(p));if(p=d.getColWidths())p=[].concat(p),p.splice(b,a),d.setColWidths(p);}};
exports.$deleteTableRow__EXPERIMENTAL=function(){var a=require("Lexical").$getSelection();require("Lexical").$isRangeSelection(a)||Q(a)||D(188);var _ref3=a.isBackward()?[a.focus.getNode(),a.anchor.getNode()]:[a.anchor.getNode(),a.focus.getNode()],b=_ref3[0],c=_ref3[1],_P8=P(b),d=_P8[0],f=_P8[2];var _P9=P(c),e=_P9[0];var _O5=O(f,d,e),g=_O5[0],m=_O5[1],p=_O5[2];a=m.startRow;var r=p.startRow;e=r+e.__rowSpan-1;if(g.length===e-a+1)f.remove();else{var _v$,_g$;r=g[0].length;var v=g[e+1],w=f.getChildAtIndex(e+1);for(var k=e;k>=a;k--){for(var l=r-1;0<=l;l--){var _g$k$l=g[k][l],n=_g$k$l.cell,q=_g$k$l.startRow,t=_g$k$l.startColumn;if(t===l&&(
k===a&&q<a&&n.setRowSpan(n.__rowSpan-(q-a)),q>=a&&q+n.__rowSpan-1>e))if(n.setRowSpan(n.__rowSpan-(e-q+1)),null===w&&D(122),0===l)ma(w,n);else{var x=v[l-1].cell;x.insertAfter(n);}}l=f.getChildAtIndex(k);K(l)||D(206,String(k));l.remove();}void 0!==v?((_v$=v[0],a=_v$.cell,_v$),N(a)):((_g$=g[a-1][0],a=_g$.cell,_g$),N(a));}};exports.$findCellNode=V;exports.$findTableNode=T;
exports.$getElementForTableNode=function(a,b){a=a.getElementByKey(b.getKey());if(null===a)throw Error("$getElementForTableNode: Table Element Not Found");return S(b,a);};exports.$getNodeTriplet=P;exports.$getTableAndElementByKey=ta;exports.$getTableCellNodeFromLexicalNode=function(a){a=require("LexicalUtils").$findMatchingParent(a,function(b){return C(b);});return C(a)?a:null;};exports.$getTableCellNodeRect=oa;exports.$getTableColumnIndexFromTableCellNode=function(a){return ia(a).getChildren().findIndex(function(b){return b.is(a);});};
exports.$getTableNodeFromLexicalNodeOrThrow=ja;exports.$getTableRowIndexFromTableCellNode=function(a){var b=ia(a);return ja(b).getChildren().findIndex(function(c){return c.is(b);});};exports.$getTableRowNodeFromTableCellNodeOrThrow=ia;
exports.$insertTableColumn=function(a,b,c,d,f){if(c===void 0){c=!0;}var e=a.getChildren(),g=[];for(var r=0;r<e.length;r++){var v=e[r];if(K(v))for(var w=0;w<d;w++){var m=v.getChildren();if(b>=m.length||0>b)throw Error("Table column target index out of range");m=m[b];C(m)||D(12);var _ka=ka(m,f),l=_ka.left,k=_ka.right;var p=y.NO_STATUS;if(l&&l.hasHeaderState(y.ROW)||k&&k.hasHeaderState(y.ROW))p|=y.ROW;p=B(p);p.append(require("Lexical").$createParagraphNode());g.push({newTableCell:p,targetCell:m});}}g.forEach(function(_ref4){var r=_ref4.newTableCell,v=_ref4.targetCell;c?
v.insertAfter(r):v.insertBefore(r);});return a;};
exports.$insertTableColumn__EXPERIMENTAL=function(a){if(a===void 0){a=!0;}function b(w){if(w===void 0){w=y.NO_STATUS;}w=B(w).append(require("Lexical").$createParagraphNode());null===r&&(r=w);return w;}var c=require("Lexical").$getSelection();require("Lexical").$isRangeSelection(c)||Q(c)||D(188);var d=c.anchor.getNode();c=c.focus.getNode();var _P10=P(d);d=_P10[0];var _P11=P(c),f=_P11[0],e=_P11[2],_O6=O(e,f,d),g=_O6[0],m=_O6[1],p=_O6[2];d=g.length;c=a?Math.max(m.startColumn,p.startColumn):Math.min(m.startColumn,p.startColumn);a=a?c+f.__colSpan-1:c-1;c=e.getFirstChild();K(c)||D(120);var r=null;var v=c;a:for(c=0;c<d;c++){0!==c&&(v=v.getNextSibling(),
K(v)||D(121));var w=g[c],l=la(w[0>a?0:a].cell.__headerState,y.ROW);if(0>a){ma(v,b(l));continue;}var _w$a=w[a],k=_w$a.cell,n=_w$a.startColumn,q=_w$a.startRow;if(n+k.__colSpan-1<=a){var t=k,x=q,z=a;for(;x!==c&&1<t.__rowSpan;){if(z-=k.__colSpan,0<=z){var _w$z=w[z],E=_w$z.cell,G=_w$z.startRow;t=E;x=G;}else{v.append(b(l));continue a;}}t.insertAfter(b(l));}else k.setColSpan(k.__colSpan+1);}null!==r&&N(r);if(d=e.getColWidths())d=[].concat(d),a=0>a?0:a,d.splice(a,0,d[a]),e.setColWidths(d);return r;};
exports.$insertTableRow=function(a,b,c,d,f){if(c===void 0){c=!0;}var e=a.getChildren();if(b>=e.length||0>b)throw Error("Table row target index out of range");b=e[b];if(K(b))for(e=0;e<d;e++){var m=b.getChildren(),p=m.length,r=I();for(var v=0;v<p;v++){var g=m[v];C(g)||D(12);var _ka2=ka(g,f),w=_ka2.above,l=_ka2.below;g=y.NO_STATUS;var k=w&&w.getWidth()||l&&l.getWidth()||void 0;if(w&&w.hasHeaderState(y.COLUMN)||l&&l.hasHeaderState(y.COLUMN))g|=y.COLUMN;g=B(g,1,k);g.append(require("Lexical").$createParagraphNode());r.append(g);}c?b.insertAfter(r):b.insertBefore(r);}else throw Error("Row before insertion index does not exist.");
return a;};
exports.$insertTableRow__EXPERIMENTAL=function(a){if(a===void 0){a=!0;}var b=require("Lexical").$getSelection();require("Lexical").$isRangeSelection(b)||Q(b)||D(188);b=b.focus.getNode();var _P12=P(b),c=_P12[0],d=_P12[2],_O7=O(d,c,c),f=_O7[0],e=_O7[1];b=f[0].length;var g=e.startRow;if(a){a=g+c.__rowSpan-1;var m=f[a];g=I();for(var p=0;p<b;p++){var _m$p=m[p],v=_m$p.cell,w=_m$p.startRow;if(w+v.__rowSpan-1<=a){var r=la(m[p].cell.__headerState,y.COLUMN);g.append(B(r).append(require("Lexical").$createParagraphNode()));}else v.setRowSpan(v.__rowSpan+1);}b=d.getChildAtIndex(a);K(b)||D(145);b.insertAfter(g);b=g;}else{m=f[g];
a=I();for(p=0;p<b;p++){var _m$p2=m[p],v=_m$p2.cell,w=_m$p2.startRow;w===g?(r=la(m[p].cell.__headerState,y.COLUMN),a.append(B(r).append(require("Lexical").$createParagraphNode()))):v.setRowSpan(v.__rowSpan+1);}b=d.getChildAtIndex(g);K(b)||D(145);b.insertBefore(a);b=a;}return b;};exports.$isScrollableTablesActive=Ha;exports.$isTableCellNode=C;exports.$isTableNode=L;exports.$isTableRowNode=K;exports.$isTableSelection=Q;
exports.$removeTableRowAtIndex=function(a,b){var c=a.getChildren();if(b>=c.length||0>b)throw Error("Expected table cell to be inside of table row.");c[b].remove();return a;};
exports.$unmergeCell=function(){var a=require("Lexical").$getSelection();require("Lexical").$isRangeSelection(a)||Q(a)||D(188);a=a.anchor.getNode();var _P13=P(a),b=_P13[0],c=_P13[1],d=_P13[2];a=b.__colSpan;var f=b.__rowSpan;if(1!==a||1!==f){var _O8=O(d,b,b),e=_O8[0],g=_O8[1],m=g.startColumn,p=g.startRow,r=b.__headerState&y.COLUMN,v=Array.from({length:a},function(t,x){t=r;for(var z=0;0!==t&&z<e.length;z++){t&=e[z][x+m].cell.__headerState;}return t;}),w=b.__headerState&y.ROW,l=Array.from({length:f},function(t,x){t=w;for(var z=0;0!==t&&z<e[0].length;z++){t&=e[x+p][z].cell.__headerState;}return t;});
if(1<a){for(var k=1;k<a;k++){b.insertAfter(B(v[k]|l[0]).append(require("Lexical").$createParagraphNode()));}b.setColSpan(1);}if(1<f){var t;for(k=1;k<f;k++){var n=p+k;var x=e[n];t=(t||c).getNextSibling();K(t)||D(125);var q=null;for(var z=0;z<m;z++){var E=x[z],G=E.cell;E.startRow===n&&(q=G);1<G.__colSpan&&(z+=G.__colSpan-1);}if(null===q)for(q=a-1;0<=q;q--){ma(t,B(v[q]|l[k]).append(require("Lexical").$createParagraphNode()));}else for(n=a-1;0<=n;n--){q.insertAfter(B(v[n]|l[k]).append(require("Lexical").$createParagraphNode()));}}b.setRowSpan(1);}}};
exports.INSERT_TABLE_COMMAND=da;exports.TableCellHeaderStates=y;exports.TableCellNode=A;exports.TableNode=Sa;exports.TableObserver=ua;exports.TableRowNode=fa;
exports.applyTableHandlers=function(a,b,c,d){function f(l){l=a.getCordsFromCellNode(l,g.table);return a.getDOMCellFromCordsOrThrow(l.x,l.y,g.table);}var e=c.getRootElement();if(null===e)throw Error("No root element.");var g=new ua(c,a.getKey()),m=c._window||window,p=R(a,b);wa(p,g);g.listenersToRemove.add(function(){var l=g;xa(p)===l&&delete p.__lexicalTableSelection;});var r=function r(){var l=function l(){g.isSelecting=!1;m.removeEventListener("mouseup",l);m.removeEventListener("mousemove",k);},k=function k(n){setTimeout(function(){if(1!==(
n.buttons&1)&&g.isSelecting)g.isSelecting=!1,m.removeEventListener("mouseup",l),m.removeEventListener("mousemove",k);else{var q=ya(n.target);null===q||g.anchorX===q.x&&g.anchorY===q.y||(n.preventDefault(),g.setFocusCellForSelection(q));}},0);};return{onMouseMove:k,onMouseUp:l};};p.addEventListener("mousedown",function(l){setTimeout(function(){if(0===l.button&&m){var k=ya(l.target);null!==k&&(X(l),g.setAnchorCellForSelection(k));var _r3=r(),n=_r3.onMouseUp,q=_r3.onMouseMove;g.isSelecting=!0;m.addEventListener("mouseup",n,g.listenerOptions);
m.addEventListener("mousemove",q,g.listenerOptions);}},0);},g.listenerOptions);m.addEventListener("mousedown",function(l){0===l.button&&c.update(function(){var k=require("Lexical").$getSelection(),n=l.target;Q(k)&&k.tableKey===g.tableNodeKey&&e.contains(n)&&g.clearHighlight();});},g.listenerOptions);g.listenersToRemove.add(c.registerCommand(require("Lexical").KEY_ARROW_DOWN_COMMAND,function(l){return W(c,l,"down",a,g);},require("Lexical").COMMAND_PRIORITY_HIGH));g.listenersToRemove.add(c.registerCommand(require("Lexical").KEY_ARROW_UP_COMMAND,function(l){return W(c,l,"up",a,g);},require("Lexical").COMMAND_PRIORITY_HIGH));g.listenersToRemove.add(c.registerCommand(require("Lexical").KEY_ARROW_LEFT_COMMAND,
function(l){return W(c,l,"backward",a,g);},require("Lexical").COMMAND_PRIORITY_HIGH));g.listenersToRemove.add(c.registerCommand(require("Lexical").KEY_ARROW_RIGHT_COMMAND,function(l){return W(c,l,"forward",a,g);},require("Lexical").COMMAND_PRIORITY_HIGH));g.listenersToRemove.add(c.registerCommand(require("Lexical").KEY_ESCAPE_COMMAND,function(l){var k=require("Lexical").$getSelection();return Q(k)&&(k=require("LexicalUtils").$findMatchingParent(k.focus.getNode(),C),C(k))?(X(l),k.selectEnd(),!0):!1;},require("Lexical").COMMAND_PRIORITY_HIGH));var v=function v(l){return function(){var k=require("Lexical").$getSelection();if(!U(k,a))return!1;if(Q(k))return g.clearText(),!0;if(require("Lexical").$isRangeSelection(k)){var n=
require("LexicalUtils").$findMatchingParent(k.anchor.getNode(),function(t){return C(t);});if(!C(n))return!1;var q=k.anchor.getNode();n=k.focus.getNode();q=a.isParentOf(q);n=a.isParentOf(n);if(q&&!n||n&&!q)return g.clearText(),!0;n=(k=require("LexicalUtils").$findMatchingParent(k.anchor.getNode(),function(t){return require("Lexical").$isElementNode(t);}))&&require("LexicalUtils").$findMatchingParent(k,function(t){return require("Lexical").$isElementNode(t)&&C(t.getParent());});if(!require("Lexical").$isElementNode(n)||!require("Lexical").$isElementNode(k))return!1;if(l===require("Lexical").DELETE_LINE_COMMAND&&null===n.getPreviousSibling())return!0;}return!1;};};[require("Lexical").DELETE_WORD_COMMAND,require("Lexical").DELETE_LINE_COMMAND,
require("Lexical").DELETE_CHARACTER_COMMAND].forEach(function(l){g.listenersToRemove.add(c.registerCommand(l,v(l),require("Lexical").COMMAND_PRIORITY_CRITICAL));});var w=function w(l){var k=require("Lexical").$getSelection();if(!Q(k)&&!require("Lexical").$isRangeSelection(k))return!1;var n=a.isParentOf(k.anchor.getNode()),q=a.isParentOf(k.focus.getNode());if(n!==q){l=n?"focus":"anchor";var _k$l=k[l],t=_k$l.key,x=_k$l.offset,z=_k$l.type;a[k[n?"anchor":"focus"].isBefore(k[l])?"selectPrevious":"selectNext"]()[l].set(t,x,z);return!1;}return Q(k)?(l&&(l.preventDefault(),l.stopPropagation()),g.clearText(),
!0):!1;};g.listenersToRemove.add(c.registerCommand(require("Lexical").KEY_BACKSPACE_COMMAND,w,require("Lexical").COMMAND_PRIORITY_CRITICAL));g.listenersToRemove.add(c.registerCommand(require("Lexical").KEY_DELETE_COMMAND,w,require("Lexical").COMMAND_PRIORITY_CRITICAL));g.listenersToRemove.add(c.registerCommand(require("Lexical").CUT_COMMAND,function(l){var k=require("Lexical").$getSelection();if(k){if(!Q(k)&&!require("Lexical").$isRangeSelection(k))return!1;void require("LexicalClipboard").copyToClipboard(c,require("LexicalUtils").objectKlassEquals(l,ClipboardEvent)?l:null,require("LexicalClipboard").$getClipboardDataFromSelection(k));l=w(l);return require("Lexical").$isRangeSelection(k)?(k.removeText(),!0):l;}return!1;},
require("Lexical").COMMAND_PRIORITY_CRITICAL));g.listenersToRemove.add(c.registerCommand(require("Lexical").FORMAT_TEXT_COMMAND,function(l){var k=require("Lexical").$getSelection();if(!U(k,a))return!1;if(Q(k))return g.formatCells(l),!0;require("Lexical").$isRangeSelection(k)&&(l=require("LexicalUtils").$findMatchingParent(k.anchor.getNode(),function(n){return C(n);}),C(l));return!1;},require("Lexical").COMMAND_PRIORITY_CRITICAL));g.listenersToRemove.add(c.registerCommand(require("Lexical").FORMAT_ELEMENT_COMMAND,function(l){var k=require("Lexical").$getSelection();if(!Q(k)||!U(k,a))return!1;var n=k.anchor.getNode();k=k.focus.getNode();if(!C(n)||!C(k))return!1;var _O9=
O(a,n,k),q=_O9[0],t=_O9[1],x=_O9[2];n=Math.max(t.startRow,x.startRow);k=Math.max(t.startColumn,x.startColumn);var z=Math.min(t.startRow,x.startRow);var E=Math.min(t.startColumn,x.startColumn);for(;z<=n;z++){for(var J=E;J<=k;J++){var G=q[z][J].cell;G.setFormat(l);G=G.getChildren();for(var M=0;M<G.length;M++){var H=G[M];require("Lexical").$isElementNode(H)&&!H.isInline()&&H.setFormat(l);}}}return!0;},require("Lexical").COMMAND_PRIORITY_CRITICAL));g.listenersToRemove.add(c.registerCommand(require("Lexical").CONTROLLED_TEXT_INSERTION_COMMAND,function(l){var k=require("Lexical").$getSelection();if(!U(k,
a))return!1;if(Q(k))g.clearHighlight();else if(require("Lexical").$isRangeSelection(k)){var n=require("LexicalUtils").$findMatchingParent(k.anchor.getNode(),function(q){return C(q);});if(!C(n))return!1;if("string"===typeof l&&(k=Oa(c,k,a)))return Na(k,a,[require("Lexical").$createTextNode(l)]),!0;}return!1;},require("Lexical").COMMAND_PRIORITY_CRITICAL));d&&g.listenersToRemove.add(c.registerCommand(require("Lexical").KEY_TAB_COMMAND,function(l){var k=require("Lexical").$getSelection();if(!require("Lexical").$isRangeSelection(k)||!k.isCollapsed()||!U(k,a))return!1;k=V(k.anchor.getNode());if(null===k)return!1;X(l);k=a.getCordsFromCellNode(k,g.table);
Ea(g,a,k.x,k.y,l.shiftKey?"backward":"forward");return!0;},require("Lexical").COMMAND_PRIORITY_CRITICAL));g.listenersToRemove.add(c.registerCommand(require("Lexical").FOCUS_COMMAND,function(){return a.isSelected();},require("Lexical").COMMAND_PRIORITY_HIGH));g.listenersToRemove.add(c.registerCommand(require("Lexical").SELECTION_INSERT_CLIPBOARD_NODES_COMMAND,function(l){var _l=l,k=_l.nodes,n=_l.selection;l=n.getStartEndPoints();var q=Q(n);q=require("Lexical").$isRangeSelection(n)&&null!==require("LexicalUtils").$findMatchingParent(n.anchor.getNode(),function(H){return C(H);})&&null!==require("LexicalUtils").$findMatchingParent(n.focus.getNode(),function(H){return C(H);})||q;if(1!==k.length||
!L(k[0])||!q||null===l)return!1;var _l2=l,t=_l2[0],x=k[0];l=x.getChildren();q=x.getFirstChildOrThrow().getChildrenSize();x=x.getChildrenSize();var z=require("LexicalUtils").$findMatchingParent(t.getNode(),function(H){return C(H);}),E=z&&require("LexicalUtils").$findMatchingParent(z,function(H){return K(H);}),G=E&&require("LexicalUtils").$findMatchingParent(E,function(H){return L(H);});if(!C(z)||!K(E)||!L(G))return!1;t=E.getIndexWithinParent();var J=Math.min(G.getChildrenSize()-1,t+x-1);x=z.getIndexWithinParent();z=Math.min(E.getChildrenSize()-1,x+q-1);q=Math.min(x,z);E=Math.min(t,J);x=Math.max(x,z);t=Math.max(t,J);G=G.getChildren();
for(J=0;E<=t;E++){z=G[E];if(!K(z))return!1;var M=l[J];if(!K(M))return!1;z=z.getChildren();M=M.getChildren();var H=0;var _loop=function _loop(Y){var sa=z[Y];if(!C(sa))return{v:!1};var Ia=M[H];if(!C(Ia))return{v:!1};var Va=sa.getChildren();Ia.getChildren().forEach(function(Z){require("Lexical").$isTextNode(Z)&&require("Lexical").$createParagraphNode().append(Z);sa.append(Z);});Va.forEach(function(Z){return Z.remove();});H++;};for(var Y=q;Y<=x;Y++){var _ret=_loop(Y);if(typeof _ret==="object")return _ret.v;}J++;}return!0;},require("Lexical").COMMAND_PRIORITY_CRITICAL));g.listenersToRemove.add(c.registerCommand(require("Lexical").SELECTION_CHANGE_COMMAND,function(){var l=require("Lexical").$getSelection(),k=require("Lexical").$getPreviousSelection();
if(g.getAndClearShouldCheckSelection()&&require("Lexical").$isRangeSelection(k)&&require("Lexical").$isRangeSelection(l)&&l.isCollapsed()){var n=l.anchor.getNode(),q=a.getFirstChild();n=V(n);if(null!==n&&K(q)){var z=q.getFirstChild();if(C(z)&&!require("LexicalUtils").$findMatchingParent(n,function(E){return E.is(z);}))return z.selectStart(),!0;}}if(require("Lexical").$isRangeSelection(l)){var _O10,_O11;var _z=l.anchor,E=l.focus;n=_z.getNode();q=E.getNode();var t=V(n),x=V(q);var G=!(!t||!a.is(T(t))),J=!(!x||!a.is(T(x)));n=G!==J;var M=G&&J;q=l.isBackward();n?(n=l.clone(),J?((_O10=O(a,x,x),x=_O10[0],_O10),t=x[0][0].cell,x=
x[x.length-1].at(-1).cell,n.focus.set(q?t.getKey():x.getKey(),q?t.getChildrenSize():x.getChildrenSize(),"element")):G&&((_O11=O(a,t,t),x=_O11[0],_O11),t=x[0][0].cell,x=x[x.length-1].at(-1).cell,n.anchor.set(q?x.getKey():t.getKey(),q?x.getChildrenSize():0,"element")),require("Lexical").$setSelection(n),Ca(c,g)):M&&!t.is(x)&&(g.setAnchorCellForSelection(f(t)),g.setFocusCellForSelection(f(x),!0),g.isSelecting||setTimeout(function(){var _r4=r(),H=_r4.onMouseUp,Y=_r4.onMouseMove;g.isSelecting=!0;m.addEventListener("mouseup",H);m.addEventListener("mousemove",
Y);},0));}else l&&Q(l)&&l.is(k)&&l.tableKey===a.getKey()&&(q=ea?(c._window||window).getSelection():null)&&q.anchorNode&&q.focusNode&&(n=(n=require("Lexical").$getNearestNodeFromDOMNode(q.focusNode))&&!a.is(T(n)),t=(t=require("Lexical").$getNearestNodeFromDOMNode(q.anchorNode))&&a.is(T(t)),n&&t&&0<q.rangeCount&&(n=require("Lexical").$createRangeSelectionFromDom(q,c)))&&(n.anchor.set(a.getKey(),l.isBackward()?a.getChildrenSize():0,"element"),q.removeAllRanges(),require("Lexical").$setSelection(n));if(l&&!l.is(k)&&(Q(l)||Q(k))&&g.tableSelection&&!g.tableSelection.is(k))return Q(l)&&
l.tableKey===g.tableNodeKey?g.updateTableTableSelection(l):!Q(l)&&Q(k)&&k.tableKey===g.tableNodeKey&&g.updateTableTableSelection(null),!1;g.hasHijackedSelectionStyles&&!a.isSelected()?Da(c,g):!g.hasHijackedSelectionStyles&&a.isSelected()&&Ca(c,g);return!1;},require("Lexical").COMMAND_PRIORITY_CRITICAL));g.listenersToRemove.add(c.registerCommand(require("Lexical").INSERT_PARAGRAPH_COMMAND,function(){var l=require("Lexical").$getSelection();return require("Lexical").$isRangeSelection(l)&&l.isCollapsed()&&U(l,a)?(l=Oa(c,l,a))?(Na(l,a),!0):!1:!1;},require("Lexical").COMMAND_PRIORITY_CRITICAL));
return g;};exports.getDOMCellFromTarget=ya;exports.getTableElement=R;exports.getTableObserverFromTableElement=xa;exports.setScrollableTablesActive=function(a,b){b?Ra.add(a):Ra["delete"](a);};}),null);
__d("trustHTML",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b;if((b=window.trustedTypes)==null?void 0:b.createPolicy){b=window.trustedTypes.createPolicy("lexical",{createHTML:function(a){return a}});return b.createHTML(a)}return a}f["default"]=a}),66);
__d("MLCUtils",["Lexical","LexicalSelection","LexicalTable","LexicalUtils","err","nullthrows","trustHTML"],(function(a,b,c,d,e,f,g){"use strict";var h={tag:"history-merge"};function i(a,b){a=a.getParent();while(a!==null){if(b(a))return a;a=a.getParent()}return null}function a(a,b){return i(a,b)!==null}function b(a){var b=d("Lexical").$getSelection();if(b!==null)return b;b=a.getEditorState()._selection;if(b===null)return null;a=b.clone();d("Lexical").$setSelection(a);return a}function e(a,b,d){d===void 0&&(d=!0);a=a._nodes.get(b.getType());if(a!==void 0){a=a.klass;if(a!==b){if(d)throw c("err")("Node type is registered but the class reference does not match");return!1}return!0}return!1}function j(a){a=a._nodes;var b=[];for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e=e[1];b.push(e.klass)}return b}function f(a,b){var c=[],e=j(a);for(var e=e,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;typeof h==="function"&&c.push(a.registerNodeTransform(h,b))}return d("LexicalUtils").mergeRegister.apply(void 0,c)}function k(a){var b=a.anchor,c=a.focus,e=a.anchor.getNode(),f=a.focus.getNode();if(e===f)return e;a=a.isBackward();if(a)return d("LexicalSelection").$isAtNodeEnd(c)?e:f;else return d("LexicalSelection").$isAtNodeEnd(b)?f:e}function l(){var a=d("Lexical").$getSelection();if(a===null)return null;var b;if(d("Lexical").$isRangeSelection(a)||d("LexicalTable").$isTableSelection(a))b=a.focus.getNode();else{a=a.getNodes();b=a[a.length-1]}a=d("LexicalUtils").$findMatchingParent(b,d("LexicalTable").$isTableCellNode);return d("LexicalTable").$isTableCellNode(a)?a:null}function m(){var a=d("Lexical").$getSelection();if(!d("Lexical").$isRangeSelection(a)||!a.isCollapsed())return!1;a=a.anchor.getNode();return d("Lexical").$isElementNode(a)&&d("Lexical").$isBlockElementNode(a)&&a.getTextContentSize()===0}var n=new WeakMap();function o(a,b,c){var d=n.get(a);d===void 0&&(d=new Map(),n.set(a,d));d.set(b,c);return a.dispatchCommand(b,c)}function p(a){var b=d("Lexical").$getSelection(),e;if(b===null){var f=d("Lexical").$getRoot();e=f.getLastChild();if(e===null){f.append.apply(f,a);return}}else d("Lexical").$isRangeSelection(b)?e=b.focus.getNode():e=c("nullthrows")(b.getNodes().at(-1));e=e.getTopLevelElementOrThrow();for(f=a.length-1;f>=0;f--)e.insertAfter(a[f])}function q(a,b){return(a=(a=n.get(a))==null?void 0:a.get(b))!=null?a:null}function r(a,b,c,d){var e=q(a,b);e!==null&&c(e,a);return a.registerCommand(b,c,d)}function s(a,b,d){b===void 0&&(b=800);d===void 0&&(d=600);a=a.getRootElement();if(a===null)return;b=window.open("","print","width="+b+",height="+d);var e=a.querySelectorAll("*"),f=new Map();for(var d=e,g=Array.isArray(d),h=0,d=g?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i,j;if(g){if(h>=d.length)break;j=d[h++]}else{h=d.next();if(h.done)break;j=h.value}j=j;var k=window.getComputedStyle(j);f.set(j,(i=j.getAttribute("style"))!=null?i:"");j.setAttribute("style",t(k))}b.document.body.innerHTML=c("trustHTML")(a.innerHTML);window.setTimeout(function(){for(var b=e,d=Array.isArray(b),g=0,b=d?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(d){if(g>=b.length)break;h=b[g++]}else{g=b.next();if(g.done)break;h=g.value}h=h;var a=c("nullthrows")(f.get(h));h.setAttribute("style",a)}},0);b.print()}function t(a){var b="";for(var c=0;c<a.length;c++){var d=a[c];b+=d+": "+a.getPropertyValue(d)+"; "}return b.trim()}g.UPDATE_HISTORY_MERGE_OPTIONS=h;g.$getAncestorPredicate=i;g.$hasAncestorPredicate=a;g.$ifNullRestoreActiveSelection=b;g.lexicalNodeIsRegistered=e;g.lexicalNodes=j;g.registerEveryNodeTransform=f;g.getSelectedNode=k;g.$getActiveTableCellNode=l;g.$isCollapsedSelectionOnEmptyBlockElement=m;g.dispatchCommandWithLVC=o;g.$insertNodesAfterBlock=p;g.lastCommandWithLVCPayload=q;g.registerCommandWithLVC=r;g.print=s}),98);
__d("MLCAutocompleteNode",["Lexical","MLCAutocompletePlugin","MLCUtils","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useEffect,k=b.useState,l=function(b){babelHelpers.inheritsLoose(a,b);a.clone=function(b){return new a(b.__uuid,b.__key)};a.getType=function(){return"autocomplete"};a.importJSON=function(a){return m(a.uuid)};var c=a.prototype;c.exportJSON=function(){return{type:"autocomplete",uuid:this.__uuid,version:1}};function a(a,c){c=b.call(this,c)||this;c.__uuid=a;return c}c.updateDOM=function(a,b,c){return!1};c.createDOM=function(a){return document.createElement("span")};c.decorate=function(a){return this.__uuid!==d("MLCAutocompletePlugin").AutocompleteUUID?null:i.jsx(n,{editor:a})};return a}(d("Lexical").DecoratorNode);function m(a){return new l(a)}function a(a){return a instanceof l}function n(a){var b=a.editor;a=k(d("MLCUtils").lastCommandWithLVCPayload(b,d("MLCAutocompletePlugin").AUTOCOMPLETE_SUGGESTION_COMMAND));var c=a[0],e=a[1];j(function(){return d("MLCUtils").registerCommandWithLVC(b,d("MLCAutocompletePlugin").AUTOCOMPLETE_SUGGESTION_COMMAND,function(a){e(a);return!1},d("Lexical").COMMAND_PRIORITY_LOW)},[b]);a=d("MLCAutocompletePlugin").ComponentMap.get(b);if(a===void 0)return null;return c===null||c.length===0?null:i.jsx(a,{suggestion:c})}n.displayName=n.name+" [from "+f.id+"]";g.MLCAutocompleteNode=l;g.$createMLCAutocompleteNode=m;g.$isMLCAutocompleteNode=a}),98);
__d("MLCAutocompletePlugin",["FBLogger","Lexical","LexicalComposerContext","LexicalSelection","LexicalUtils","MLCAutocompleteNode","MLCUtils","react","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h;h||(h=d("react"));var i=h.useEffect,j=new WeakMap(),k=c("uuidv4")(),l=d("Lexical").createCommand("AUTOCOMPLETE_SUGGESTION_COMMAND");function m(a){if(!d("Lexical").$isRangeSelection(a)||!a.isCollapsed())return null;var b=a.getNodes()[0];a=a.anchor;if(!d("Lexical").$isTextNode(b)||!b.isSimpleText()||!d("LexicalSelection").$isAtNodeEnd(a))return null;a=b.getTextContent();return a.trim().length===0?null:a}function a(a){var b=a.Component,e=a.getSuggestion,f=a.onAccept;a=d("LexicalComposerContext").useLexicalComposerContext();var g=a[0];i(function(){if(j.has(g))throw c("FBLogger")("lexical").mustfixThrow("MLCAutocompletePlugin registered twice");j.set(g,b);return function(){j["delete"](g)}},[b,g]);i(function(){var a=null,b=null,c=null,h=null;function i(){var e=a!==null?d("Lexical").$getNodeByKey(a):null;e!==null&&e.isAttached()&&(e.remove(),a=null);b=null;c=null;h=null;d("MLCUtils").dispatchCommandWithLVC(g,l,null)}function j(b){var c=b.getKey();b.__uuid===k&&c!==a&&i()}function n(){g.update(function(){var f=d("Lexical").$getSelection();if(!d("Lexical").$isRangeSelection(f)){i();return}h!==f.anchor.key&&(b=null,c=null);var j=m(f);if(j==null||j.length===0){i();return}if(j===b)return;b=j;j=e(j);if(c!=null&&c===j)return;c=j;if(j==null||j.length===0){i();return}var n=a!==null?d("Lexical").$getNodeByKey(a):null;if(n==null||!n.isAttached()){n==null?void 0:n.remove();var o=f.clone(),p=d("MLCAutocompleteNode").$createMLCAutocompleteNode(k);a=p.getKey();o.insertNodes([p]);d("Lexical").$setSelection(o)}else if(f.anchor.key!==h){n.remove();p=f.clone();p.insertNodes([n]);d("Lexical").$setSelection(p);h=p.anchor.key}d("MLCUtils").dispatchCommandWithLVC(g,l,j)})}function o(){if(a===null)return!1;var b=d("Lexical").$getNodeByKey(a);if(b===null)return!1;if(c===null)return!1;var e=d("Lexical").$createTextNode(c);b.replace(e);e.selectNext();f!=null&&c!=null&&f(c);i();return!0}function p(a){if(o()){a.preventDefault();return!0}return!1}function q(){g.update(function(){i()})}return d("LexicalUtils").mergeRegister(g.registerNodeTransform(d("MLCAutocompleteNode").MLCAutocompleteNode,j),g.registerUpdateListener(n),g.registerCommand((j=d("Lexical")).KEY_TAB_COMMAND,p,j.COMMAND_PRIORITY_HIGH),g.registerCommand(j.KEY_ARROW_RIGHT_COMMAND,p,j.COMMAND_PRIORITY_HIGH),q)},[g,e,f]);return null}a.displayName=a.name+" [from "+f.id+"]";g.ComponentMap=j;g.AutocompleteUUID=k;g.AUTOCOMPLETE_SUGGESTION_COMMAND=l;g.AutocompletePlugin=a}),98);
__d("UnifiedShareSheetMessengerComposer.react",["fbt","CometComposerEditorForLexicalBootstrapPlugin.react","CometLexicalContentEditable.react","CometLexicalPlaceholder.react","FDSText.react","FeedComposerCometTextStyleContext","Lexical","LexicalComposerContext","LexicalErrorBoundary","LexicalHistoryPlugin","LexicalLinkPlugin","LexicalPlainTextPlugin","UnifiedShareSheetConstants","react","stylex","useUnifiedShareSheetLogger"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));b=j;b.useCallback;var l=b.useEffect;b.useMemo;var m=b.useRef,n=b.c,o={editor:{alignItems:"x6s0dn4",cursor:"x1ed109x",display:"x1lliihq",fontSize:"x6prxxf",height:"x5yr21d",overflowY:"x1odjw0f",position:"x1n2onr6",width:"xh8yej3",$$css:!0},form:{backgroundColor:"xmjcpbm",borderTopStartRadius:"x107yiy2",borderTopEndRadius:"xv8uw2v",borderBottomEndRadius:"x1tfwpuw",borderBottomStartRadius:"x2g32xy",cursor:"x1ed109x",display:"x78zum5",flexGrow:"x1iyjqo2",flexShrink:"xs83m0k",maxHeight:"xo1bdp9",minHeight:"xisnujt",paddingTop:"x1y1aw1k",paddingEnd:"x1pi30zi",paddingBottom:"xwib8y2",paddingStart:"x1swvt13",position:"x1n2onr6",$$css:!0},placeholder:{alignItems:"x6s0dn4",display:"x78zum5",height:"x5yr21d",$$css:!0}};function a(a){var b=n(27),e=a.editor,f=a.feedLocation,g=a.shareableID,j=a.shareSheetComponentVariant,p=a.sharingComponentName;a=a.xstyle;var q;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(q=d("LexicalComposerContext").createLexicalComposerContext(),b[0]=q):q=b[0];b[1]!==e?(q=[e,q],b[1]=e,b[2]=q):q=b[2];q=q;q=q;var r=c("useUnifiedShareSheetLogger")(),s=r.onShareOptionSelected,t;b[3]!==e||b[4]!==s||b[5]!==f||b[6]!==g||b[7]!==p||b[8]!==j?(r=function(){return e.registerCommand(d("Lexical").FOCUS_COMMAND,function(){s({entry_point:f,shareable_entity_fbid:g,sharing_component_name:p,sharing_component_variant:j});return!0},d("Lexical").COMMAND_PRIORITY_EDITOR)},t=[e,f,s,g,j,p],b[3]=e,b[4]=s,b[5]=f,b[6]=g,b[7]=p,b[8]=j,b[9]=r,b[10]=t):(r=b[9],t=b[10]);l(r,t);b[11]===Symbol["for"]("react.memo_cache_sentinel")?(r=d("LexicalHistoryPlugin").createEmptyHistoryState(),b[11]=r):r=b[11];t=r;r=t;t=m(null);var u=m(null),v;b[12]===Symbol["for"]("react.memo_cache_sentinel")?(v=function(a){a=(a=a)!=null?a:null;u.current=a},b[12]=v):v=b[12];v=v;var w;b[13]===Symbol["for"]("react.memo_cache_sentinel")?(w=h._("__JHASH__R7hbXAekzQ8__JHASH__"),b[13]=w):w=b[13];w=w;var x;b[14]!==a?(x=(i||(i=c("stylex")))(o.form,a),b[14]=a,b[15]=x):x=b[15];b[16]===Symbol["for"]("react.memo_cache_sentinel")?(a="x78zum5 x1iyjqo2 x5yr21d x1n2onr6",b[16]=a):a=b[16];var y;b[17]===Symbol["for"]("react.memo_cache_sentinel")?(y=w.toString(),b[17]=y):y=b[17];b[18]===Symbol["for"]("react.memo_cache_sentinel")?(y=k.jsx(d("LexicalPlainTextPlugin").PlainTextPlugin,{ErrorBoundary:d("LexicalErrorBoundary").LexicalErrorBoundary,contentEditable:k.jsx(c("CometLexicalContentEditable.react"),{"aria-placeholder":y,contentEditableRef:v,isInitiallyFocused:!0,placeholder:k.jsx(c("CometLexicalPlaceholder.react"),{xstyle:o.placeholder,children:k.jsx(c("FDSText.react"),{color:"placeholder",numberOfLines:1,type:"body3",children:w})}),spellCheck:!0,tabIndex:0,xstyle:o.editor})}),v=k.jsx(d("LexicalLinkPlugin").LinkPlugin,{}),w=k.jsx(d("LexicalHistoryPlugin").HistoryPlugin,{externalHistoryState:r}),r=k.jsx(c("CometComposerEditorForLexicalBootstrapPlugin.react"),{autoFocus:!0,inputElementRef:u,textAlignment:"left"}),b[18]=y,b[19]=v,b[20]=w,b[21]=r):(y=b[18],v=b[19],w=b[20],r=b[21]);b[22]!==q?(a=k.jsx("div",{className:a,children:k.jsx(c("FeedComposerCometTextStyleContext").Provider,{value:d("UnifiedShareSheetConstants").TEXT_STYLE,children:k.jsxs(d("LexicalComposerContext").LexicalComposerContext.Provider,{value:q,children:[y,v,w,r]})})}),b[22]=q,b[23]=a):a=b[23];b[24]!==x||b[25]!==a?(y=k.jsx("form",{className:x,method:"POST",ref:t,children:a}),b[24]=x,b[25]=a,b[26]=y):y=b[26];return y}g["default"]=a}),226);
__d("UnifiedShareSheetMessengerLexicalCreateEditor",["CometLexicalDelightNode","CometLexicalEmojiNode","CometLexicalGenericEntityNode","FBLogger","Lexical","LexicalLink","LexicalOverflow","MLCAutocompleteNode","cometLexicalBaseTheme","mlcErrorHandler__INTERNAL"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=d("Lexical").createEditor({namespace:"UnifiedShareSheetMessengerComposer",nodes:[d("CometLexicalGenericEntityNode").CometLexicalGenericEntityNode,d("CometLexicalEmojiNode").EmojiNode,d("CometLexicalDelightNode").CometLexicalDelightNode,d("MLCAutocompleteNode").MLCAutocompleteNode,d("LexicalOverflow").OverflowNode,d("LexicalLink").LinkNode].filter(Boolean),onError:function(b){return c("mlcErrorHandler__INTERNAL")(b,a,function(a){c("FBLogger")("unfied_share_sheet_messenger_composer").catching(b).mustfix("Lexical Error: %s",a)})},theme:babelHelpers["extends"]({},c("cometLexicalBaseTheme"),{characterLimit:"xayplqe xt0psk2",paragraph:"xdj266r x11i5rnm xat24cr x1mh8g0r x16tdsg8"})});return a}g["default"]=a}),98);
__d("UnifiedShareSheetMessengerMultiSelectionDialogQuery.graphql",["UnifiedShareSheetMessengerMultiSelectionDialogQuery_facebookRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnifiedShareSheetMessengerMultiSelectionDialogQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{kind:"Defer",selections:[{args:null,kind:"FragmentSpread",name:"UnifiedShareSheetSendMessageButton_viewer"}]}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UnifiedShareSheetMessengerMultiSelectionDialogQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{"if":null,kind:"Defer",label:"UnifiedShareSheetMessengerMultiSelectionDialogQuery$defer$UnifiedShareSheetSendMessageButton_viewer",selections:[{alias:null,args:null,kind:"ScalarField",name:"chat_tabs_turned_off",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]}],storageKey:null}]},params:{id:b("UnifiedShareSheetMessengerMultiSelectionDialogQuery_facebookRelayOperation"),metadata:{},name:"UnifiedShareSheetMessengerMultiSelectionDialogQuery",operationKind:"query",text:null}};b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("UnifiedShareSheetMultiSelectionContextProvider",["UnifiedShareSheetConstants","UnifiedShareSheetMultiSelectionContext","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useMemo;var j=b.c;function a(a){var b=j(15),e=a.children,f=a.initialSelectedTarget,g=a.setSendButtonStatus,h;b[0]!==f?(h=new Map(),f!=null&&!h.has(f.id)&&h.set(f.id,f),b[0]=f,b[1]=h):h=b[1];b[2]!==h||b[3]!==g?(a=function(a){a!=null&&(h.has(a.id)||h.set(a.id,a),h.size>1&&h.size===2?g(d("UnifiedShareSheetConstants").SEND_BUTTON_STATUS.SEND_SEPARATELY):h.size===1&&g(d("UnifiedShareSheetConstants").SEND_BUTTON_STATUS.SEND))},b[2]=h,b[3]=g,b[4]=a):a=b[4];f=a;b[5]!==h||b[6]!==g?(a=function(a){a!=null&&(h.has(a)&&h["delete"](a),h.size<=1&&h.size===1?g(d("UnifiedShareSheetConstants").SEND_BUTTON_STATUS.SEND):h.size===0&&g(d("UnifiedShareSheetConstants").SEND_BUTTON_STATUS.DISABLED))},b[5]=h,b[6]=g,b[7]=a):a=b[7];a=a;var k;b[8]!==f||b[9]!==a||b[10]!==h?(k={AddSeletectTarget:f,RemoveSelectedTarget:a,selectedTargets:h},b[8]=f,b[9]=a,b[10]=h,b[11]=k):k=b[11];f=k;a=f;b[12]!==a||b[13]!==e?(k=i.jsx(c("UnifiedShareSheetMultiSelectionContext").Provider,{value:a,children:e}),b[12]=a,b[13]=e,b[14]=k):k=b[14];return k}g["default"]=a}),98);
__d("UnifiedShareSheetMessengerMultiSelectionDialog.react",["fbt","CometColumn.react","CometColumnItem.react","CometErrorBoundary.react","CometPlaceholder.react","CometRelay","CometUnifiedShareSheetErrorState.react","FDSDialogHeader.react","FDSDialogPage.react","MWFacebookUserWithoutMessengerAccess","UnifiedShareSheetConstants","UnifiedShareSheetHScrollContainerPlaceholder.react","UnifiedShareSheetMessengerLexicalCreateEditor","UnifiedShareSheetMessengerMultiSelectionDialogQuery$Parameters","UnifiedShareSheetMessengerMultiSelectionDialogQuery.graphql","UnifiedShareSheetMessengerSection.react","UnifiedShareSheetMultiSelectionContextProvider","UnifiedShareSheetSendMessageButtonPlaceholder.react","UnifiedShareSheetSendMessageComposerPlaceholder.react","deferredLoadComponent","react","requireDeferredForDisplay","usePartialViewImpression","usePopPage","useRefetchablePreloadedQuery","useUnifiedShareSheetLogger"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));e=j;var l=e.useCallback,m=e.useMemo,n=e.useState,o=c("deferredLoadComponent")(c("requireDeferredForDisplay")("UnifiedShareSheetMessengerComposer.react").__setRef("UnifiedShareSheetMessengerMultiSelectionDialog.react")),p=c("deferredLoadComponent")(c("requireDeferredForDisplay")("UnifiedShareSheetSendMessageButton.react").__setRef("UnifiedShareSheetMessengerMultiSelectionDialog.react")),q=i!==void 0?i:i=b("UnifiedShareSheetMessengerMultiSelectionDialogQuery.graphql");function a(a){var b=a.props;a=a.queries;var e=c("useRefetchablePreloadedQuery")(c("UnifiedShareSheetMessengerMultiSelectionDialogQuery$Parameters"),a.multipleSelectionQueryReference),f=e[0];e=e[1];e=d("CometRelay").usePreloadedQuery(q,e);var g=a.multipleSelectionQueryReference.variables,i=l(function(){f(g)},[f,g]),j=b.LSresults,r=b.feedLocation,s=b.feedTracking,t=b.hasLightSpeedResults,u=b.initialScrollToIndex,v=b.initialSelectedTarget,w=b.onClose,x=b.shareableID,y=b.storyData,z=b.xmaDataPromise,A=m(function(){return{editor:c("UnifiedShareSheetMessengerLexicalCreateEditor")(),inputState:{__type:"lexical-editor-state-based"}}},[]);A=A.editor;var B=c("useUnifiedShareSheetLogger")(),C=B.onSharesheetImpression,D=c("usePopPage")();B=c("usePartialViewImpression")({onImpressionStart:function(){C({entry_point:b.feedLocation,shareable_entity_fbid:x,sharing_component_name:"hscroll_multiselect_suggested_recipient",sharing_component_variant:"unified_share_sheet"})}});var E=n(d("UnifiedShareSheetConstants").SEND_BUTTON_STATUS.SEND),F=E[0];E=E[1];var G=d("MWFacebookUserWithoutMessengerAccess").useIsFacebookUserWithoutMessengerAccess(),H=h._("__JHASH__dCysyBJfkNb__JHASH__"),I=h._("__JHASH__v5lMsoiFXPW__JHASH__");G=G?I:H;return k.jsx(c("UnifiedShareSheetMultiSelectionContextProvider"),{initialSelectedTarget:v,setSendButtonStatus:E,children:k.jsx(c("FDSDialogPage.react"),{footer:null,header:k.jsx(c("FDSDialogHeader.react"),{onBack:function(){D&&D()},onClose:w,text:G,withBackButton:!0,withCloseButton:!0}),mobileFullHeight:!1,children:k.jsx(c("CometErrorBoundary.react"),{fallback:function(a){return k.jsx(c("CometUnifiedShareSheetErrorState.react"),{handleRefresh:i})},children:k.jsxs(c("CometColumn.react"),{paddingTop:8,paddingVertical:16,ref:B,spacing:16,children:[k.jsx(c("CometColumnItem.react"),{paddingHorizontal:0,children:k.jsx(c("CometPlaceholder.react"),{fallback:k.jsx(c("UnifiedShareSheetHScrollContainerPlaceholder.react"),{}),name:"UnifiedShareSheetMessengerMultiSelectionDialog.MessengerSection",children:k.jsx(c("UnifiedShareSheetMessengerSection.react"),{LSresults:j,enableMultiSelection:!0,feedLocation:r,feedTracking:s,hasLightSpeedResults:t,initialScrollToIndex:u,initialSelectedIndex:b.initialSelectedIndex,messengerQueryReference:a.messengerQueryReference,onClose:b.onClose,shareableID:b.shareableID,shareableUrl:b.shareableUrl,storyData:y,xmaDataPromise:z})})}),k.jsx(c("CometColumnItem.react"),{paddingHorizontal:16,paddingTop:0,children:k.jsx(c("CometPlaceholder.react"),{fallback:k.jsx(c("UnifiedShareSheetSendMessageComposerPlaceholder.react"),{}),name:"UnifiedShareSheetMessengerMultiSelectionDialog.Composer",children:k.jsx(o,{editor:A,feedLocation:r,shareSheetComponentVariant:"unified_share_sheet",shareableID:x,sharingComponentName:"hscroll_multiselect_message_composer"})})}),k.jsx(c("CometColumnItem.react"),{paddingHorizontal:16,paddingTop:0,children:k.jsx(c("CometPlaceholder.react"),{fallback:k.jsx(c("UnifiedShareSheetSendMessageButtonPlaceholder.react"),{}),name:"UnifiedShareSheetMessengerMultiSelectionDialog.SendMessageButton",children:k.jsx(p,{editor:A,feedLocation:r,feedTracking:s,onClose:w,sendButtonStatus:F,shareableID:b.shareableID,storyData:y,url:b.shareableUrl||"",viewerRef:e==null?void 0:e.viewer,xmaDataPromise:z})})})]})})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("UnifiedShareSheetSendMessageButton_viewer.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnifiedShareSheetSendMessageButton_viewer",selections:[{alias:null,args:null,kind:"ScalarField",name:"chat_tabs_turned_off",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null};e.exports=a}),null);
__d("useMWSendAttachment",["$InternalEnum","CometMessengerShareGating","CometRelay","CometUnifiedShareSheetGating","FBLogger","JSResourceForInteraction","LSDatabaseSingleton","LSMessagingThreadAttributionType","MAWVerifyThreadCutoverDeferred","MWLSLogSend","MWVersion","MaybeUpdateTargetBasedOnODCutoverOrDefaultE2EEDeferred","asyncToGeneratorRuntime","cr:2898","cr:3536","gkx","isThreadLevelCutoverEnabled","qex","react","sendToSentQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i;f=h||d("react");f.useCallback;var j=f.c,k=b("$InternalEnum").Mirrored(["USS_H_SCROLL","BCF"]);function l(){if(c("qex")._("77")===!0||c("qex")._("68")===!0)return!0;else return c("qex")._("121")===!0}var m=b("cr:2898")||b("cr:3536"),n=c("JSResourceForInteraction")("LSShareAttachment").__setRef("useMWSendAttachment");function a(){var a=j(2),e=d("CometRelay").useRelayEnvironment(),f;a[0]!==e?(f=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,f=a.attachment,g=a.lssTraceApi,h=a.reshareTarget,j=a.s2sInstanceKey,o=a.secureXmaMessageType,p=a.sharingComponent,q=a.source,r=a.thread,s=a.xmaDataPromise;a=a.xmaDataProps;var t=l(),u=t||c("isThreadLevelCutoverEnabled")();d("sendToSentQPLLogger").markSendToSentPoint(j,"update_target_deferred_component_load_start");var v=(yield c("MaybeUpdateTargetBasedOnODCutoverOrDefaultE2EEDeferred").load());d("sendToSentQPLLogger").markSendToSentPoint(j,"update_target_deferred_component_load_end");d("sendToSentQPLLogger").markSendToSentPoint(j,"update_target_start");v=(yield v(h,(i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton,"sendAttachment",j));d("sendToSentQPLLogger").markSendToSentPoint(j,"update_target_end");f=v.targetID!==f.targetID?babelHelpers["extends"]({},f,{targetID:v.targetID}):f;var w=function(a){d("MWLSLogSend").logSentHeroInteraction(g,a,{isMessageRequest:!1,mwVersion:d("MWVersion").v2,source:(a=q)!=null?a:c("LSMessagingThreadAttributionType").UNKNOWN,threadType:r==null?void 0:r.threadType});d("sendToSentQPLLogger").markSendToSentPoint(j,"offline_msg_id_generated");g.addMarkerPoint("offline_msg_id_generated","AppTiming")};b=(b=v.isTargetE2E)!=null?b:t;t=!1;d("sendToSentQPLLogger").markSendToSentPoint(j,"verify_thread_cutover_start");g.addMarkerPoint("verify_thread_cutover_start","AppTiming");if(c("MAWVerifyThreadCutoverDeferred")!=null){d("sendToSentQPLLogger").markSendToSentPoint(j,"verify_cutover_deferred_component_load_start");var x=(yield c("MAWVerifyThreadCutoverDeferred").load());x=x.verifyThreadCutoverWithStringInput;d("sendToSentQPLLogger").markSendToSentPoint(j,"verify_cutover_deferred_component_load_end");t=(yield x((i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton,v.targetID))}d("sendToSentQPLLogger").markSendToSentPoint(j,"verify_thread_cutover_end");if(u&&b||t){if(m===null){d("sendToSentQPLLogger").markSendToSentFail(j,"MAWShareAttachmentDeferred_null");g.addMarkerPoint("MAWShareAttachmentDeferred_null","AppTiming");throw c("FBLogger")("messenger_web_media").mustfixThrow("Failed to fetch MAWShareAttachmentDeferred")}d("sendToSentQPLLogger").markSendToSentPoint(j,"share_attachment_deferred_component_load_start");x=(yield m.load());u=x.shareSecureAttachment;d("sendToSentQPLLogger").markSendToSentPoint(j,"share_attachment_deferred_component_load_end");d("sendToSentQPLLogger").markSendToSentPoint(j,"share_secure_attachment_start");b=p===k.BCF&&d("CometMessengerShareGating").shouldEnableBCFSingleFetchXMA()||p===k.USS_H_SCROLL&&d("CometUnifiedShareSheetGating").shouldEnableUSSSingleFetchXMA();b?yield u(void 0,f,v,q,j,o,"useMWSendAttachment",w,g,a,s):yield u(e,f,v,q,j,o,"useMWSendAttachment",w,g,void 0,s);d("sendToSentQPLLogger").markSendToSentPoint(j,"share_secure_attachment_end");return v}else{t=(yield n.load());x=t.share;yield x(f,j);return h}});return function(b){return a.apply(this,arguments)}}(),a[0]=e,a[1]=f):f=a[1];return f}function e(){var a=j(2);if(a[0]===Symbol["for"]("react.memo_cache_sentinel")){var b=l()||!1;b=b||c("isThreadLevelCutoverEnabled")();a[0]=b}else b=a[0];var d=b;a[1]===Symbol["for"]("react.memo_cache_sentinel")?(b=function(){d?(m==null?void 0:m.preload(),c("gkx")("8490")&&(c("MAWVerifyThreadCutoverDeferred")==null?void 0:c("MAWVerifyThreadCutoverDeferred").preload(),c("MaybeUpdateTargetBasedOnODCutoverOrDefaultE2EEDeferred")==null?void 0:c("MaybeUpdateTargetBasedOnODCutoverOrDefaultE2EEDeferred").preload())):n.preload()},a[1]=b):b=a[1];return b}g.SharingComponentType=k;g.useMWSendAttachment=a;g.useMWPreloadSendAttachmentComponents=e}),98);
__d("useUnifiedShareSheetPopChat",["SharingConstants","react","useMWChatOpenTabForGroup","useMWChatOpenTabForPage","useMWChatOpenTabForUser"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.c;function a(){var a=i(4),b=c("useMWChatOpenTabForUser")(d("SharingConstants").MESSENGER_POPUP_ENTRYPOINT),e=b.openTabByThreadKey;b=c("useMWChatOpenTabForGroup")(d("SharingConstants").MESSENGER_POPUP_ENTRYPOINT);b[0];b[1];var f=b[2],g=c("useMWChatOpenTabForPage")(d("SharingConstants").MESSENGER_POPUP_ENTRYPOINT);a[0]!==e||a[1]!==f||a[2]!==g?(b=function(a){var b=a.isSecureShare;a=a.target;bb2:switch(a.targetType){case"USER":e(a.targetID,b);break bb2;case"GROUP":f(a.targetID,b);break bb2;case"PAGE":g(a.targetID);break bb2;default:}},a[0]=e,a[1]=f,a[2]=g,a[3]=b):b=a[3];return b}g["default"]=a}),98);
__d("UnifiedShareSheetSendMessageButton.react",["fbt","ix","CometLinkSharingContext","CometLinkSharingUtil","CometMessengerReshareUtil","CometRelay","CometUnifiedShareSheetGating","FBLogger","FDSButton.react","I64","LSMessagingThreadAttributionType","LSSLogger","MAWFetchXMAData","MAWSecureComposerText","MAWThreadId","MWSharedMsgLogUtils","Promise","RelayHooks","SharingConstants","SilenceableErrorMessageUtils","UnifiedShareSheetConstants","UnifiedShareSheetMultiSelectionContext","UnifiedShareSheetSendMessageButton_viewer.graphql","asyncToGeneratorRuntime","cometPushToast","fbicon","gkx","isStringNullOrEmpty","promiseDone","react","recoverableViolation","requireDeferred","sendToSentQPLLogger","unrecoverableViolation","useMWSendAttachment","useReStore","useUnifiedShareSheetLogger","useUnifiedShareSheetPopChat"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k,l,m,n,o=n||(n=d("react"));e=n;var p=e.useCallback,q=e.useContext,r=e.useMemo,s=c("requireDeferred")("ShareMetricsLoggingController").__setRef("UnifiedShareSheetSendMessageButton.react"),t=h._("__JHASH__TpCbmnXtLDI__JHASH__"),u=h._("__JHASH__c5lF0BE9eTk__JHASH__"),v=d("CometUnifiedShareSheetGating").shouldEnableUSSSingleFetchXMA();function a(a){var e=a.editor,f=a.feedLocation,g=a.feedTracking,n=a.onClose,w=a.sendButtonStatus,x=a.shareableID,y=a.storyData,z=a.url,A=a.viewerRef,B=a.xmaDataPromise,C=d("CometMessengerReshareUtil").isXMAFeedPostShareEnabled()||!1;a=q(c("CometLinkSharingContext"));var D=a.getWrappedShareUrlID;a=q(c("UnifiedShareSheetMultiSelectionContext"));var E=a.selectedTargets;a=d("CometRelay").useFragment(j!==void 0?j:j=b("UnifiedShareSheetSendMessageButton_viewer.graphql"),A);A=a==null?void 0:a.actor;var F=A==null?void 0:A.id,G=r(function(){return{entry_point:f,feed_tracking:g?g.toString():"",sharing_component_name:"hscroll_multiselect_suggested_recipient"}},[f,g]),H=r(function(){var a;return{entry_point:f,feed_tracking:(a=g)!=null?a:[""],sharing_component_name:"hscroll_multiselect_suggested_recipient"}},[g,f]),I=c("useUnifiedShareSheetLogger")(),J=I.onSendMessageButtonInUSSAttempted,K=I.onSendMessageInMessengerSuccessful,L=I.onSendMessageInMessengerUSSFailed,M=I.onSendMessageInMessengerUSSSuccessful;if(F==null||A==null||x==null)throw c("unrecoverableViolation")("Need a viewer id, actor, story, and postID in order to share a story","fb_social_experience_web_sharing");var N=c("useUnifiedShareSheetPopChat")(),O=(a==null?void 0:a.chat_tabs_turned_off)===!0,P=d("useMWSendAttachment").useMWSendAttachment();I=d("useMWSendAttachment").useMWPreloadSendAttachmentComponents();var Q=(l||(l=c("useReStore")))();A=d("LSSLogger").useLSSLogger();var R=A.traceLocalSendMessageAsync,S=d("RelayHooks").useRelayEnvironment(),T=p(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,g,h,i){a={isTargetE2E:a.isTargetE2E,targetID:a.targetID,targetType:a.targetType,typeName:a.typeName};var j="user",k="one_to_one";switch(a.targetType){case"USER":j="user";k="one_to_one";break;case"GROUP":j="group";k="group";break;case"PAGE":j="page";k="one_to_one";break;default:j="user"}var l=D(y==null?void 0:y.id);l={actorID:F,entryPoint:d("SharingConstants").MESSENGER_POPUP_ENTRYPOINT,message:b,messagingInformTreatmentInfo:y==null?void 0:y.messagingInformTreatmentInfo,shareID:(l=l)!=null?l:x,targetID:a.targetID,targetType:j,url:z};var n=(j=i)!=null?j:d("sendToSentQPLLogger").markSendToSentStart(),o=(i=h)!=null?i:yield R();try{j=(yield d("MAWThreadId").getThreadFromJid(Q.tables,(m||(m=d("I64"))).of_string(a.targetID)));h=j!=null?c("LSMessagingThreadAttributionType").FB_FEED_ORGANIC_POST_VIEW_AND_MESSAGE:c("LSMessagingThreadAttributionType").UNKNOWN;if(j!=null){i=d("MWSharedMsgLogUtils").getMessageTypeParams({messageText:b,sentFromShareSheet:!0,threadType:j.threadType});c("promiseDone")(d("MWSharedMsgLogUtils").getSendToSentAnnotations(j,i,h),function(a){a.string=babelHelpers["extends"]({},a.string,{attachment_type:"share",message_type:"share",root_component:"UnifiedShareSheetSendMessageButton",surface:f}),a["int"]={number_targets:e},d("sendToSentQPLLogger").addSendToSentAnnotations(n,a),o.addAnnotationInt("number_targets",e),o.addAnnotation("surface",f||"unknown")});d("MWSharedMsgLogUtils").addSendMessageMetadataForInteractionTrace(o,i,j,"UnifiedShareSheetSendMessageButton")}d("sendToSentQPLLogger").markSendToSentPoint(n,"start_post_sharing");i=(yield P({attachment:l,lssTraceApi:o,reshareTarget:a,s2sInstanceKey:n,sharingComponent:d("useMWSendAttachment").SharingComponentType.USS_H_SCROLL,source:h,thread:j,xmaDataPromise:B,xmaDataProps:g}));s.onReady(function(a){a.logShareFunnelEvent({fb_entry_point:"send_in_message",fb_feed_location:f,fb_share_type:"share_created",shareable_id:null})});J(babelHelpers["extends"]({},G,{is_link_sharing_url_used:d("CometLinkSharingUtil").isLinkSharingUrlUsed(z),is_text_attached:!c("isStringNullOrEmpty")(b),receiver_type:k}));d("sendToSentQPLLogger").markSendToSentSuccess(n);M(babelHelpers["extends"]({},G));K(babelHelpers["extends"]({},H,{receiver_count:E.size.toString()}));if(!O){N({isSecureShare:(l=i.isTargetE2E)!=null?l:C,target:i})}}catch(a){d("sendToSentQPLLogger").markSendToSentFail(n,"unknown_xma_error",a);o.failTrace(a,!0);throw a}});return function(b,c,d,e,f,g){return a.apply(this,arguments)}}(),[D,y==null?void 0:y.id,y==null?void 0:y.messagingInformTreatmentInfo,F,x,z,R,Q.tables,P,J,G,M,K,H,E.size,O,f,N,C,B]),U=p(function(a){s.onReady(function(a){a.logShareFunnelEvent({fb_entry_point:"send_in_message",fb_feed_location:f,fb_share_type:"share_failure",shareable_id:null})});L(babelHelpers["extends"]({},G));a=d("SilenceableErrorMessageUtils").getMetadataFromError(a.error);if(d("SilenceableErrorMessageUtils").shouldHideErrorMessage(a))return;d("cometPushToast").cometPushErrorToast({message:h._("__JHASH__WcIF2-D1xlx__JHASH__")})},[f,G,L]),V=p(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=e.getEditorState(),f=d("MAWSecureComposerText").getTextFromEditorState(a);n();var g={linkType:"unknown"},h=new Map();if(v){a=Array.from(E.values()).map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("sendToSentQPLLogger").markSendToSentStart(),c=(yield R());a!=null&&h.set(a,{lssTraceApi:c,s2sInstanceKey:b});return h});return function(b){return a.apply(this,arguments)}}());yield (k||(k=b("Promise"))).all(a);z==null&&(h.forEach(function(a){a.lssTraceApi.failTrace("null_xma_url",!0),d("sendToSentQPLLogger").markSendToSentFail(a.s2sInstanceKey,"null_xma_url")}),c("FBLogger")("messenger_web_sharing").mustfix("[MAWShareAttachment] Attachment URL is null"));var i=[];h.forEach(function(a){a.lssTraceApi.addMarkerPoint("xma_data_query_start","AppTiming"),d("sendToSentQPLLogger").markSendToSentPoint(a.s2sInstanceKey,"xma_data_query_start"),i.push(a.s2sInstanceKey)});B!=null&&c("gkx")("8695")?g=(yield B):g=(yield d("MAWFetchXMAData").fetchXMAData(S,z,i));h.forEach(function(a){a.lssTraceApi.addMarkerPoint("xma_data_query_end","AppTiming"),d("sendToSentQPLLogger").markSendToSentPoint(a.s2sInstanceKey,"xma_data_query_end")})}if(v){a=Array.from(E.values()).map(function(a){var b;return a!=null&&T(a,f,E.size,g,(b=h.get(a))==null?void 0:b.lssTraceApi,(b=h.get(a))==null?void 0:b.s2sInstanceKey)});yield (k||(k=b("Promise"))).all(a)}else E.forEach(function(a){a!=null&&c("promiseDone")(T(a,f,E.size,void 0,void 0,void 0))})}catch(a){U(a);c("recoverableViolation")("error on sending message in unified share sheet. "+a.message,"fb_social_experience_web_sharing");return}}),[e,U,n,E,T,S,R,z]);a=w===d("UnifiedShareSheetConstants").SEND_BUTTON_STATUS.SEND_SEPARATELY?u:t;return o.jsx(c("FDSButton.react"),{disabled:w===d("UnifiedShareSheetConstants").SEND_BUTTON_STATUS.DISABLED,icon:d("fbicon")._(i("505616"),16),label:a,onHoverIn:I,onPress:function(){return c("promiseDone")(V())}})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);