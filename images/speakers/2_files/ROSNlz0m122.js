;/*FB_PKG_DELIM*/

__d("MAWSecureThreadQPContainerV2Query_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="8486986448022073"}),null);
__d("MAWSecureThreadQPContainerV2Query.graphql",["MAWSecureThreadQPContainerV2Query_facebookRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"Literal",name:"surface_nux_id",value:8879},{kind:"Literal",name:"trigger",value:"MESSENGER_E2EE_THREAD_OPEN"}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MAWSecureThreadQPContainerV2Query",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:a,concreteType:"ViewerEligibleQuickPromotionsConnection",kind:"LinkedField",name:"eligible_promotions",plural:!1,selections:[{kind:"Defer",selections:[{args:null,kind:"FragmentSpread",name:"MAWSecureThreadQuickPromotion_eligiblePromotions"}]}],storageKey:'eligible_promotions(surface_nux_id:8879,trigger:"MESSENGER_E2EE_THREAD_OPEN")'}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"MAWSecureThreadQPContainerV2Query",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:a,concreteType:"ViewerEligibleQuickPromotionsConnection",kind:"LinkedField",name:"eligible_promotions",plural:!1,selections:[{"if":null,kind:"Defer",label:"MAWSecureThreadQPContainerV2Query$defer$MAWSecureThreadQuickPromotion_eligiblePromotions",selections:[{alias:null,args:null,concreteType:"QuickPromotion",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:"CometQuickPromotionSections",kind:"LinkedField",name:"comet_qp_sections",plural:!1,selections:[{alias:null,args:[{kind:"Literal",name:"supported",value:"1OzhWV"}],concreteType:null,kind:"LinkedField",name:"renderer_strategy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"MAWSecureThreadQuickPromotion_eligiblePromotions",fragmentName:"CometQuickPromotionArmadilloXMAPreviewSettingsNUXRendererStrategy_quickPromotionRef",fragmentPropName:"quickPromotionRef",kind:"ModuleImport"}],type:"CometQuickPromotionArmadilloXMAPreviewSettingsNUXRendererStrategy",abstractKey:null}],storageKey:'renderer_strategy(supported:"1OzhWV")'}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]}],storageKey:'eligible_promotions(surface_nux_id:8879,trigger:"MESSENGER_E2EE_THREAD_OPEN")'}],storageKey:null}]},params:{id:b("MAWSecureThreadQPContainerV2Query_facebookRelayOperation"),metadata:{},name:"MAWSecureThreadQPContainerV2Query",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("MAWSecureThreadQPContainerV2.react",["CometErrorBoundary.react","CometPlaceholder.react","CometRelay","MAWSecureThreadQPContainerV2Query.graphql","MAWSecureThreadQuickPromotion.react","emptyFunction","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||(i=d("react"))).c,k=i,l=h!==void 0?h:h=b("MAWSecureThreadQPContainerV2Query.graphql");function a(){var a=j(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=k.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MAWSecureThreadQPContainer.Query",children:k.jsx(m,{})}),a[0]=b):b=a[0];return b}function m(){var a=j(2),b=d("CometRelay").useLazyLoadQuery(l,{});b=b==null?void 0:(b=b.viewer)==null?void 0:b.eligible_promotions;if(b==null)return null;var e;a[0]!==b?(e=k.jsx(c("CometErrorBoundary.react"),{fallback:c("emptyFunction"),children:k.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MAWSecureThreadQPContainer.EligiblePromotions",children:k.jsx(c("MAWSecureThreadQuickPromotion.react"),{eligiblePromotions:b})})}),a[0]=b,a[1]=e):e=a[1];return e}g["default"]=a}),98);
__d("MWOnDemandCutoverThreadPreview.react",["Int64Hooks","MAWOnDemandCutoverTrigger","MWOptimisticSecureThreadPreview.react","promiseDone","react","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(7),e=a.otherContactIdForOnDemandCutoverThread;a=a.tab;var f=c("useAsyncReStore")(),g,h;b[0]!==e||b[1]!==f?(g=function(){if(e==null)return;c("promiseDone")(f,function(a){d("MAWOnDemandCutoverTrigger").triggerOnDemandCutoverAndCreateSecureThread(a,e,"chatTab")})},h=[f,e],b[0]=e,b[1]=f,b[2]=g,b[3]=h):(g=b[2],h=b[3]);d("Int64Hooks").useEffectInt64(g,h);b[4]!==e||b[5]!==a?(g=j.jsx(c("MWOptimisticSecureThreadPreview.react"),{otherContactIdForOptimisticSecureThread:e,tab:a}),b[4]=e,b[5]=a,b[6]=g):g=b[6];return g}g["default"]=a}),98);
__d("MWRetryMessageSend.react",["fbt","BaseMiddot.react","FBLogger","I64","LSIntEnum","LSThreadAttributionTypeUtil","MAWMiActOnActThreadReady","MWSharedMsgLogUtils","MWXLink.react","MWXText.react","MessengerWebUXLogger","ReQL","WAStanzaUtils","asyncToGeneratorRuntime","promiseDone","react","sendToSentQPLLogger","useAsyncReStore","useLSMessagingSource","useMAWSendMessageV2","useMWLSDefaultThreadSource","useThrottled"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=(i||(i=d("react"))).c,m=i;function a(a){var e=l(19),f=a.message,g=c("useAsyncReStore")(),i=c("useMWLSDefaultThreadSource")(),n=c("useMAWSendMessageV2")(),o=c("MessengerWebUXLogger").useInteractionLogger();e[0]===Symbol["for"]("react.memo_cache_sentinel")?(a={eventName:"secure_message_retry_impression"},e[0]=a):a=e[0];a=c("MessengerWebUXLogger").useImpressionLoggerRef(a);var p=c("useLSMessagingSource")(),q;e[1]!==o||e[2]!==g||e[3]!==f.threadKey||e[4]!==f.hotEmojiSize||e[5]!==f.text||e[6]!==f.offlineThreadingId||e[7]!==f.timestampMs||e[8]!==p||e[9]!==n||e[10]!==i?(q=function(){var a=d("sendToSentQPLLogger").markSendToSentStart();d("sendToSentQPLLogger").markSendToSentPoint(a,"retry_secure_message_start");o==null?void 0:o({eventName:"secure_message_retry_lick"});c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield g),e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(b.tables.threads).getKeyRange(f.threadKey)));if(e==null){d("sendToSentQPLLogger").markSendToSentFail(a,"message_retry_fail");throw c("FBLogger")("messenger_web_messaging").mustfixThrow("Failed while fetching thread from DB in MWRetryMessageSend.react")}var h=d("LSThreadAttributionTypeUtil").getSource(e.threadKey,p),l=d("MWSharedMsgLogUtils").getMessageTypeParams({hotEmojiSize:f.hotEmojiSize,messageText:f.text,threadType:e.threadType});d("sendToSentQPLLogger").addSendToSentAnnotations(a,yield d("MWSharedMsgLogUtils").getSendToSentAnnotations(e,l,(j||(j=d("LSIntEnum"))).unwrapIntEnum(h),"retry-button"));l=(yield d("MAWMiActOnActThreadReady").waitForACTThreadReady(b.tables,e.threadKey,"getChatJid"));yield n(b,e.threadKey,e.threadType,l.chatJid,(h=f.text)!=null?h:"",i(e.threadKey),void 0,f.offlineThreadingId,(k||(k=d("I64"))).to_int32(f.timestampMs),f.hotEmojiSize,!1,void 0,void 0,void 0,void 0,void 0,a,d("WAStanzaUtils").toStanzaId(f.offlineThreadingId))})())},e[1]=o,e[2]=g,e[3]=f.threadKey,e[4]=f.hotEmojiSize,e[5]=f.text,e[6]=f.offlineThreadingId,e[7]=f.timestampMs,e[8]=p,e[9]=n,e[10]=i,e[11]=q):q=e[11];q=q;var r=c("useThrottled")(q,2500);e[12]===Symbol["for"]("react.memo_cache_sentinel")?(q=m.jsx(c("BaseMiddot.react"),{}),e[12]=q):q=e[12];var s;e[13]!==r?(s=function(){r()},e[13]=r,e[14]=s):s=e[14];var t;e[15]===Symbol["for"]("react.memo_cache_sentinel")?(t=h._("__JHASH__9CDNHt9PfWl__JHASH__"),e[15]=t):t=e[15];e[16]!==s||e[17]!==a?(q=m.jsxs(m.Fragment,{children:[q,m.jsx(c("MWXText.react"),{color:"negative",type:"bodyLink4",children:m.jsx(c("MWXLink.react"),{onClick:s,ref:a,children:t})})]}),e[16]=s,e[17]=a,e[18]=q):q=e[18];return q}g["default"]=a}),226);
__d("useCometSubscribeMessengerIsOnDemandCutoverEligible",["LSContactBitOffset","LSMessagingThreadTypeUtil","MAWThreadCutover","ReQL","ReQLSuspense","gkx","react","useEnsureContactsExistAndUpdated","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||d("react")).c;function a(a,b){var e=j(12);c("useEnsureContactsExistAndUpdated")(b!=null&&d("LSMessagingThreadTypeUtil").isOpenOneToOne(b)?a:void 0,c("gkx")("8672"));var g=(h||(h=c("useReStore")))(),i,k;e[0]!==a||e[1]!==b||e[2]!==g?(i=function(){return a!=null&&b!=null&&d("LSMessagingThreadTypeUtil").isOpenOneToOne(b)?d("ReQL").fromTableAscending(g.tables.contacts,[].concat(d("LSContactBitOffset").contactCapabilityFields,["id"])).getKeyRange(a):d("ReQL").empty()},k=[g,a,b],e[0]=a,e[1]=b,e[2]=g,e[3]=i,e[4]=k):(i=e[3],k=e[4]);i=d("ReQLSuspense").useFirst(i,k,f.id+":42");k=d("MAWThreadCutover").useIsCutoverOpenThread(a);if(b==null||!d("LSMessagingThreadTypeUtil").isOpenOneToOne(b)||k){e[5]===Symbol["for"]("react.memo_cache_sentinel")?(k=[!1,!0,null],e[5]=k):k=e[5];return k}if(i==null){e[6]===Symbol["for"]("react.memo_cache_sentinel")?(k=[!1,!1,null],e[6]=k):k=e[6];return k}e[7]!==i?(k=i!=null&&d("LSContactBitOffset").has(76,i),e[7]=i,e[8]=k):k=e[8];k=k;var l;e[9]!==k||e[10]!==i.id?(l=[k,!0,i.id],e[9]=k,e[10]=i.id,e[11]=l):l=e[11];return l}g["default"]=a}),98);